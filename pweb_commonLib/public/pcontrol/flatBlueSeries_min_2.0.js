(function () {;function persagy_tool(){this.enterName="controlInit",this.persagyCreateType="p-create",this.typeSeparator="-",this.persagyRely="p-rely",this.persagyCreateBind="p-bind",this.pbindEventFnName="_pbindEventForOtherLibary",this.pstaticEventFnName="_pstaticEventForOtherLibary",this.attrPrefix="{{",this.attrSuffix="}}",this.cssStart=' class="',this.cssAttrEnd='"',this.libraryToPro="_ppro",this.libraryTypeToHtml="_pt",this.libraryIdToHtml="_id",this.eventCurrTargetName="_currentTarget",this.eventOthAttribute="pEventAttr",this.registeredEventRcord="_peventrecord",this.timerNameToElement="_timer",this.titleSourceAttr="ptitle",this.isRenderedToProName="_rendered",this.controlPrivateToProName="_other",this.maxDivMarker="pc",this.verifyResult="verify",this.pcontrolState={on:"on",off:"off",success:"success",failure:"failure"},this.shape={rectangle:"rectangle",ellipse:"ellipse"},this.orientation={up:"up",down:"down",left:"left",right:"right"},this.align={center:"center",left:"left",right:"right"},this.arrangeType={horizontal:"horizontal",vertical:"vertical"},this.verifyType={space:{name:"space",stringFnName:"pisSpace"},length:{name:"length",stringFnName:"pvalidLength"},chinese:{name:"chinese",stringFnName:"pisChinese"},email:{name:"email",stringFnName:"pisEmail"},idcard:{name:"idcard",stringFnName:"pisCard"},negativeint:{name:"negativeint",stringFnName:"pisNegativeInt"},positiveint:{name:"正整数",stringFnName:"pisPositiveInt"},"int":{name:"int",stringFnName:"pisInt"},negativenumber:{name:"negativenumber",stringFnName:"pisNegativeNumber"},positivenumber:{name:"positivenumber",stringFnName:"pisPositiveNumber"},number:{name:"number",stringFnName:"pisNumber"},tel:{name:"tel",stringFnName:"pisTel"},mobile:{name:"mobile",stringFnName:"pisMobile"}},this.sortType={asc:"asc",desc:"desc"}}persagy_tool.prototype.constructorCon=function(e){return persagy_tool.instanceFactory(e)},persagy_tool.prototype.createControl=function(e,t,n,r){var i=this.constructorCon(e);return i[this.enterName]?i[this.enterName](t,n,r):""},persagy_tool.prototype.getTypeByPcreate=function(e){var t=ptool.getJqElement(e);if(!t)return console.error("获取容器对象失败");var n=t.attr(this.persagyCreateType)||"";return this.getTypeAndChildType(n)},persagy_tool.prototype.getTypeAndChildType=function(e){var t=(e||"").split(this.typeSeparator),n=t[0],r=t[1];return{controlType:n,childType:r}},persagy_tool.prototype.getTypeAndChildTypeFromEle=function(e){var t=$(e).attr(this.libraryTypeToHtml);return this.getTypeAndChildType(t)},persagy_tool.prototype.oldGetBind=function(e){function o(e){var n=[],r={};while(e.length>0){var i=e.substring(0,1);switch(i){case"[":if(e.substring(1,2)!="{"){var s=e.substring(0,e.indexOf("]")+1);return e=e.substring(e.indexOf("]")+1),{val:s,str:e}}e=e.substring(1);while(e.length>0){var o=arguments.callee(e);n.push(o.val),e=o.str.substring(1);if(o.str.substring(0,1)=="]")break}return{val:n,str:e};case"{":case",":e=e.substring(1),i=e.substring(0,1);if(i=="}")return arguments.callee(e);var u="";i=="'"||i=='"'?(e=e.substring(1),u=e.substring(0,e.indexOf(i))):u=e.substring(0,e.indexOf(":")),e=e.substring(e.indexOf(":")+1);var a=arguments.callee(e);e=a.str;var f=a.val;r[u.ptrimHeadTail()]=f;break;case"}":case"]":return e=e.substring(1),{val:r,str:e};default:var l=e.indexOf(","),c=e.indexOf("}"),h=-1;h=l>c||l==-1?c:l;var s=e.substring(0,h),p=t.valueParse(s);return e=e.substring(h),{val:p,str:e}}}return{val:r,str:e}}var t=this,n=/(\?|\:|==)/g;e=ptool.getJqElement(e);if(!e)return!1;var r=e.attr(t.persagyCreateBind)||"";if(!r)return!1;r.indexOf("{")!==0&&(r="{"+r+"}");var i=o(r).val;i.attr=i.attr||{};var s=e.attr(t.persagyRely);return i.attr.bind=s==="true"?!0:!1,e.removeAttr(t.persagyCreateType),e.removeAttr(t.persagyCreateBind),e.removeAttr(t.persagyRely),i},persagy_tool.prototype.valueParse=function(e){var t=e==="true"?!0:e==="false"?!1:null;return t!=null?t:(t=parseFloat(e),isNaN(t)?e||"":t)},persagy_tool.prototype.elementAppendPattr=function(e,t,n,r){var i=t+this.typeSeparator+n;e[this.libraryToPro]={type:i,objBind:r}},persagy_tool.prototype.getInstanceFromDom=function(e){var t=this.getTypeAndChildTypeFromEle(e);return this.constructorCon(t.controlType)},persagy_tool.prototype.appendProToEvent=function(e,t){return e[this.eventOthAttribute]=t,e},persagy_tool.prototype.createDynamicTemplate=function(e,t){t=t||ptool.produceId();var n='<script type="text/html" id="'+t+'">'+e+"</script>";return $(document.body).append(n),t},persagy_tool.prototype.verifying=function(e,t,n){var r=this.verifyType[e].stringFnName;return t[r](n)},persagy_tool.prototype.splitStrByKey=function(e,t){for(var n=0;n<t.length;n++){var r=t.substr(n,e.length);if(r==e){var i=t.substring(0,n),s=t.substr(n+e.length);return{start:i,key:e,end:s}}}return!1},persagy_tool.getInstance=function(){return persagy_tool.instanceFactory(persagy_tool)},persagy_tool.instanceFactory=function(name){var fn=typeof name=="string"?eval(name):name;return fn?fn._instance||(fn._instance=new fn)||fn._instance:!1};function persagy_event(){this.constructor=arguments.callee}persagy_event.prototype.createEvent=function(e,t,n,r){if(!e)return;$(e).on(n,r)},persagy_event.prototype.staticEventExecute=function(eventCallName){return function(fnName){return function(event){if(typeof fnName=="function")return fnName(event);var fn=eval(fnName);if(typeof fn=="function")return fn(event)}}(eventCallName)},persagy_event.getInstance=function(){return persagy_tool.instanceFactory(persagy_event)};function persagy_toBind(){this.ptool=persagy_tool.getInstance(),this.frameTypes={ko:"ko",Vue:"Vue"},this.currFrameType=null,this.attr={id:{bind:' id="',position:1},name:{bind:' name="',position:1},bind:{bind:"",position:3},disabled:{bind:' pdisabled="',position:1},value:{bind:' value="',position:1},text:{bind:"",position:2},errtext:{bind:"",position:2},tiptext:{bind:"",position:2},title:{bind:' ptitle="',position:1},name:{bind:' name="',position:1},icon:{bind:"",position:2},isborder:{bind:"",position:3},shape:{bind:"",position:3},state:{bind:"",position:3},subtitle:{bind:"",position:2},templateid:{bind:"",position:2},orientation:{bind:"",position:3},align:{bind:"",position:3},istree:{bind:"",position:3},datasource:{bind:"",position:3},placeholder:{bind:' placeholder="',position:1},isshade:{bind:"",position:3},accept:{bind:' accept="',position:1},number:{bind:"",position:3},arrange:{bind:"",position:3}},this.event={click:"click",mousedown:"mousedown",mouseup:"mouseup",mouseover:"mouseover",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",mousewheel:"mousewheel",change:"change",beforechange:"",input:"input",focus:"focus",blur:"blur",sel:"",beforesel:"",scroll:"",hide:"",beforehide:""},this.css={overallcss:'class="',iconcss:'class="'},this.getFrameName()}function persagy_ko(){this.constructor=arguments.callee,this.attr={id:{bind:"id:",position:1},name:{bind:" name:",position:1},bind:{bind:"",position:3},disabled:{bind:"pdisabled:",position:1},value:{bind:" value:",position:2},text:{bind:"text:",position:2},errtext:{bind:"text:",position:2},tiptext:{bind:"text:",position:2},title:{bind:"title:",position:1},name:{bind:" name:",position:1},icon:{bind:"text:",position:2},isborder:{bind:"",position:3},shape:{bind:"",position:3},state:{bind:"",position:3},subtitle:{bind:"text:",position:2},orientation:{bind:"",position:3},align:{bind:"",position:3},istree:{bind:"",position:3},datasource:{bind:"",position:3},placeholder:{bind:" placeholder:",position:1},isshade:{bind:"",position:3},accept:{bind:" accept:",position:1},number:{bind:"",position:3},arrange:{bind:"",position:3},templateid:{bind:"",position:2}},this.event={click:"click:",mousedown:"mousedown:",mouseup:"mouseup:",mouseover:"mouseover:",mouseout:"mouseout:",mouseenter:"mouseenter:",mouseleave:"mouseleave:",mousewheel:"mousewheel:",change:"",beforechange:"",input:"input:",focus:"focus:",blur:"blur:",sel:"",beforesel:"",scroll:"",hide:"",beforehide:""},this.css={}}function persagy_Vue(){this.attr={id:{bind:' :id="',position:1},name:{bind:' :name="',position:1},bind:{bind:"",position:3},disabled:{bind:' :pdisabled="',position:1},value:{bind:' v-model="',position:1},text:{bind:' v-text="',position:1},errtext:{bind:' v-text="',position:1},tiptext:{bind:' v-text="',position:1},title:{bind:' :title="',position:1},name:{bind:' :name="',position:1},icon:{bind:' v-text="',position:1},isborder:{bind:"",position:3},shape:{bind:"",position:3},state:{bind:"",position:3},subtitle:{bind:' v-text="',position:2},orientation:{bind:"",position:3},align:{bind:"",position:3},istree:{bind:"",position:3},datasource:{bind:"",position:3},placeholder:{bind:' :placeholder="',position:1},isshade:{bind:"",position:3},accept:{bind:' :accept="',position:1},number:{bind:"",position:3},arrange:{bind:"",position:3},templateid:{bind:"",position:2}},this.event={click:' @click="',mousedown:' @mousedown="',mouseup:' @mouseup="',mouseover:' @mouseover="',mouseout:' @mouseout="',mouseenter:' @mouseenter="',mouseleave:' @mouseleave="',mousewheel:' @mousewheel="',change:"",beforechange:"",input:' @input="',focus:' @focus="',blur:' @blur="',sel:"",beforesel:"",scroll:"",hide:"",beforehide:""},this.css={}}persagy_toBind.prototype=persagy_event.getInstance(),persagy_toBind.getInstance=function(){return persagy_tool.instanceFactory(persagy_toBind)},persagy_toBind.prototype.getFrameName=function(){for(var frame in this.frameTypes){if(this.frameTypes.hasOwnProperty(frame)==0)continue;try{var currFrame=eval(this.frameTypes[frame]);return this.currFrameType=frame}catch(exception){}}},persagy_toBind.prototype.joinHtmlByAttrCss=function(e,t,n){t=t||{},n=n||{};for(var r in this.attr){if(this.attr.hasOwnProperty(r)==0)continue;var i=this.attr[r];if(i.position==3)continue;var s=this.ptool.attrPrefix+r+this.ptool.attrSuffix,o=e.indexOf(s);if(o==-1)continue;var u=o+s.length;if(!t[r]&&t[r]!==!1){e=e.substring(0,o)+e.substring(u);continue}switch(i.position){case 1:var a=i.bind+t[r]+this.ptool.cssAttrEnd;e=e.substring(0,o)+a+e.substring(u);break;case 2:var f=e.substring(0,o),l=e.substring(u),c=l.indexOf(">"),h=l.substring(0,c+1),p=l.substring(c+1),d=t[r];d=r.toLocaleLowerCase()!="templateid"?d:document.getElementById(d).innerHTML,e=f+h+d+p}}for(var v in n){if(n.hasOwnProperty(v)==0)continue;var m=this.ptool.attrPrefix+v+this.ptool.attrSuffix,g=e.indexOf(m);if(g==-1)continue;var y=g+m.length;if(!n[v]){e=e.substring(0,g)+e.substring(y);continue}var f=e.substring(0,g),h=e.substring(y),b=f.lastIndexOf("<"),w=f.lastIndexOf(this.ptool.cssStart),E=w+this.ptool.cssStart.length,S=h.indexOf(">"),x=h.indexOf(this.ptool.cssStart),T=x+this.ptool.cssStart.length;if(w>b){var l=f.substring(0,E),p=f.substring(E);e=l+n[v]+" "+p+h}else if(x<S){var l=h.substring(0,T),p=h.substring(T);e=f+l+n[v]+" "+p}else e=f+this.ptool.cssStart+n[v]+this.ptool.cssAttrEnd+h}for(var N in this.event){if(this.event.hasOwnProperty(N)==0)continue;var C=this.ptool.attrPrefix+N+this.ptool.attrSuffix,k=e.indexOf(C);if(k==-1)continue;var L=k+C.length;e=e.substring(0,k)+e.substring(L)}return e},persagy_toBind.prototype.joinHtmlToBindByAttrCss=function(e,t,n,r,i){t=t||{},n=n||{},r=r||{},i=i===!0?!0:!1,this.currFrameType||this.getFrameName();var s=persagy_tool.instanceFactory("persagy_"+this.currFrameType);return s.createBind(e,t,n,r,i)},persagy_toBind.prototype.createForBind=function(e,t,n){n=n===!0?!0:!1,this.currFrameType||this.getFrameName();var r=persagy_tool.instanceFactory("persagy_"+this.currFrameType);return r.createForBind(e,t,n)},persagy_toBind.prototype.createStyleBind=function(e,t){this.currFrameType||this.getFrameName();var n=persagy_tool.instanceFactory("persagy_"+this.currFrameType);return n.createStyleBind(e,t)},persagy_toBind.getInstance=function(){return persagy_tool.instanceFactory(persagy_toBind)},persagy_ko.prototype=new persagy_toBind,persagy_ko.prototype.createBind=function(e,t,n,r){function o(e){var n=e.indexOf(">");if(n==-1)return e;var o=e.substring(0,n),u=e.substring(n);if(n==0)return o=e.substring(0,1),u=e.substring(1),o+arguments.callee(u);var a="",f="";for(var l in i.attr){if(i.attr.hasOwnProperty(l)==0)continue;var c=i.attr[l];if(c.position==3)continue;var h=i.ptool.attrPrefix+l+i.ptool.attrSuffix,p=o.indexOf(h);if(p==-1)continue;var d=p+h.length;o=o.substring(0,p)+o.substring(d);var v=t[l];if(v==null)continue;if(l=="templateid"){u=u.substr(0,1)+document.getElementById(v).innerHTML+u.substr(1);continue}var m=c.bind+(v||"$data");switch(c.position){case 1:a+=(a?",":"")+m;break;case 2:f+=(f?",":"")+m}}a=a?"attr:{"+a+"}":"";var g=a+(a?",":"")+f,y="";for(var b in r){if(r.hasOwnProperty(b)==0)continue;var w=i.ptool.attrPrefix+b+i.ptool.attrSuffix,E=o.indexOf(w);if(E==-1)continue;var S=E+w.length;o=o.substring(0,E)+o.substring(S);if(!r[b])continue;y+=(y.length>0?",":"")+"'"+b+"':"+r[b]}y="css:{"+y+"}",y=g&&y?","+y:y;var x="";for(var T in i.event){if(i.event.hasOwnProperty(T)==0)continue;if(!i.event[T])continue;var N=i.ptool.attrPrefix+T+i.ptool.attrSuffix,C=o.indexOf(N);if(C==-1)continue;var k=C+N.length;o=o.substring(0,C)+o.substring(k),x+=(x?",":"")+i.event[T]+s.pbindEventFnName}x=x?"event:{"+x+"}":"",x=(g||y)&&x?","+x:x;var L=g||y||x?' data-bind="'+g+y+x+'"':"";return u=arguments.callee(u),o+L+u}var i=this,s=persagy_tool.getInstance();return o(e)},persagy_ko.prototype.createForBind=function(e,t){return"<!-- ko foreach: "+t+" -->"+e+"<!-- /ko -->"},persagy_ko.prototype.createStyleBind=function(e,t){t=t||{};var n="";for(var r in t){if(t.hasOwnProperty(r)==0)continue;var i=r,s=t[r];n+=(n.length>0?",":"")+"'"+i+"':"+s}n="style:{"+n+"}";var o=$(e),u=o.attr("data-bind");return u!=null&&(n=u+","+n),o.attr("data-bind",n),o[0].outerHTML},persagy_ko.getInstance=function(){return persagy_tool.instanceFactory(persagy_ko)},persagy_Vue.prototype=new persagy_toBind,persagy_Vue.prototype.createBind=function(e,t,n,r,i){function f(e){var n=e.indexOf(">");if(n==-1)return e;var i=e.substring(0,n),f=e.substring(n);if(n==0)return i=e.substring(0,1),f=e.substring(1),i+arguments.callee(f);var l="";for(var c in u.attr){if(u.attr.hasOwnProperty(c)==0)continue;var h=u.attr[c];if(h.position==3)continue;var p=u.ptool.attrPrefix+c+u.ptool.attrSuffix,d=i.indexOf(p);if(d==-1)continue;var v=d+p.length;i=i.substring(0,d)+i.substring(v);var m=t[c];if(m==null)continue;if(c=="templateid"){f=f.substr(0,1)+document.getElementById(m).innerHTML+f.substr(1);continue}var g=h.bind+s+(m?o+m:"")+u.ptool.cssAttrEnd;l+=g}var y="";for(var b in r){if(r.hasOwnProperty(b)==0)continue;var w=u.ptool.attrPrefix+b+u.ptool.attrSuffix,E=i.indexOf(w);if(E==-1)continue;var S=E+w.length;i=i.substring(0,E)+i.substring(S);if(!r[b])continue;y+=(y?",":"")+"'"+b+"':"+s+r[b]}y=y?' v-bind:class="{'+y+'}"':"";var x="";for(var T in u.event){if(u.event.hasOwnProperty(T)==0)continue;if(!u.event[T])continue;var N=u.ptool.attrPrefix+T+u.ptool.attrSuffix,C=i.indexOf(N);if(C==-1)continue;var k=C+N.length;i=i.substring(0,C)+i.substring(k),x+=u.event[T]+a.pbindEventFnName+"(model,$event)"+u.ptool.cssAttrEnd}var L=l+y+x;return f=arguments.callee(f),i+L+f}var s=i===!0?"model":"",o=i===!0?".":"",u=this,a=persagy_tool.getInstance();return f(e)},persagy_Vue.prototype.createForBind=function(e,t,n){var r=e.indexOf(">"),i=e.substring(0,r),s=e.substring(r);return i=i+" "+'v-for="model in '+(n===!0?"model.":"")+t+'"',i+s},persagy_Vue.prototype.createStyleBind=function(e,t){t=t||{};var n="";for(var r in t){if(t.hasOwnProperty(r)==0)continue;var i=r,s=t[r];n+=(n.length>0?",":"")+"'"+i+"':"+s}n="{"+n+"}";var o=$(e);return o.attr("v-bind:style",n),o[0].outerHTML},persagy_Vue.getInstance=function(){return persagy_tool.instanceFactory(persagy_Vue)};function persagyElement(){this.constructor=arguments.callee,this.extendFn={pinit:function(e,t,n){persagy_tool.getInstance().createControl(e,t,this,n)},prender:function(){var e=persagy_tool.getInstance(),t=persagyElement.getInstance(),n=t.controlTypes,r="";for(var i in n){if(n.hasOwnProperty(i)==0)continue;var s=n[i].types;for(var o=0;o<s.length;o++){var u=s[o];r=r+(r.length>0?",":"")+i+e.typeSeparator+u}}var a=$(this).find(r);a.length>0&&a.each(function(){var t=e.getTypeAndChildType(this.tagName.toLowerCase());e.createControl(t.controlType,t.childType,this,null)})},psel:"",ptoggle:"",pshow:"",phide:"",psetScroll:"",pcss:"",pval:"",phideTextTip:function(){var e=$(this),t=new ptext_template;e.find("["+t.errMarker+"],["+t.friendlyMarker+"]").hide(),e.find("["+t.textMarker+"]").removeClass(t.errCss),e.attr(t.ptool.verifyResult,"true")},pshowTextTip:function(e){var t=$(this),n=new ptext_template;t.find("["+n.errTextMarker+"]").text(e),t.find("["+n.errMarker+"]").show(),t.find("["+n.textMarker+"]").addClass(n.errCss),t.attr(n.ptool.verifyResult,"false")},pverifi:function(){var e=$(this),t=persagy_tool.getInstance(),n=persagyElement.getInstance().controlTypes,r=e.attr(t.maxDivMarker)!=null?e:e.find("["+t.maxDivMarker+"]"),i=new ptext_template;for(var s=0;s<r.length;s++){var o=r.eq(s);if(o.attr(t.verifyResult)=="false")return!1;var u=t.getTypeAndChildTypeFromEle(o),a,f;u.controlType==n.ptext.name?(a=o.pval(),f=ptext):u.controlType==n.pcombobox.name?(a=o.psel().text,f=pcombobox):"";if(!f)continue;var l=o.attr(t.libraryIdToHtml),c=f[l],h=c.attr,p=h.verify;p instanceof Array||(p=[h.verify]);for(var s=0;s<p.length;s++){var d=p[s];if(!d.verifytype)continue;var v=d.verifytype===t.verifyType.length.name?parseInt(d.length):"",m=t.verifying(d.verifytype,a,v);d.verifytype==i.ptool.verifyType["space"].name&&(m=!m);if(!m)return o.find("["+i.errTextMarker+"]").text(d.errtip||""),!1}}return!0},precover:function(){var e=$(this),t=persagy_tool.getInstance(),n=persagyElement.getInstance(),r=e.attr(t.maxDivMarker)!=null?e:e.find("["+t.maxDivMarker+"]");for(var i=0;i<r.length;i++){var s=r[i],o=t.getInstanceFromDom(s);if(!o)continue;if(typeof o.precover!="function")continue;o.precover.apply(s,arguments)}},pcount:"",plock:""},this.controlTypes={pbutton:{name:"pbutton",types:["white","blue","borderred","backred","menumain","menuminor"]},pcombobox:{name:"pcombobox",types:["normal","custom","menumain","menuminor","text","page","time"]},pswitch:{name:"pswitch",types:["checkbox","radio","slide"]},pnotice:{name:"pnotice",types:["message","nodata"]},ploading:{name:"ploading",types:["global","part"]},pscroll:{name:"pscroll",types:["small"]},ptab:{name:"ptab",types:["button","text","navigation"]},ptext:{name:"ptext",types:["text","textarea","combobox"]},pwindow:{name:"pwindow",types:["global","modal","confirm","float","bubble"]},pupload:{name:"pupload",types:["attachment","img"]},ppage:{name:"ppage",types:["simple","full"]},psearch:{name:"psearch",types:["delay","promptly"]},ptree:{name:"ptree",types:["normal"]},ptime:{name:"ptime",types:["form","calendar"]},pgrid:{name:"pgrid",types:["normal","multifunction"]},plogin:{name:"plogin",types:["normal"]},pframe:{name:"pframe",types:["normal"]}}}persagyElement.prototype=persagy_toBind.getInstance(),persagyElement.prototype.controlInit=function(e,t,n){var r=n||this.ptool.oldGetBind(t)||!1,i=ptool.getJqElement(t);if(!r){var s,o={},u={},a={};for(var f in this.attr){if(this.attr.hasOwnProperty(f)==0)continue;s=i[0].getAttribute(f);if(!s)continue;o[f]=this.ptool.valueParse(s),i.removeAttr(f)}for(var l in this.event){if(this.event.hasOwnProperty(l)==0)continue;s=i.attr(l);if(!s)continue;u[l]=s,i.removeAttr(l)}for(var c in this.css){if(this.css.hasOwnProperty(c)==0)continue;s=i.attr(c);if(!s)continue;a[c]=s,i.removeAttr(c)}var h=ptool.getDomElement(t),p=h.attributes,d=null;for(var v=0;v<p.length;v++){var m=p[v];d||(d={}),d[m.name]=m.value}r={attr:o,event:u,css:a,customAttr:d}}return r.attr.bind=r.attr.bind===!0?!0:!1,this.init(e,r,i)},persagyElement.prototype.renderView=function(e,t,n,r,i,s){var o="<div>"+e+"</div>",u=$(o);u.prender(),e=u.html().replace(/(\}\}\=\"\")/g,"}}");var a=ptool.produceId(),f=this.createHtml(e,r,t,n);return this.constructor[a]=r,this.htmlReplace(i,f,r,t,n,a,s)},persagyElement.prototype.createHtml=function(e,t,n,r){var i=t.attr,s=t.customAttr,o=t.event,u=t.css;if(s){var a=e.indexOf(">"),f=e.substring(0,a),l=e.substring(a);for(var c in s){if(s.hasOwnProperty(c)==0)continue;f+=" "+c+'="'+s[c]+'"'}e=f+l}return i.bind===!1?this.joinHtmlByAttrCss(e,i,u):this.joinHtmlToBindByAttrCss(e,i,o,u)},persagyElement.prototype.htmlReplace=function(e,t,n,r,i,s,o){var u=ptool.getJqElement(e),a=$(t),f=r+this.ptool.typeSeparator+i;return a.attr(this.ptool.libraryTypeToHtml,f),a.attr(this.ptool.libraryIdToHtml,s),typeof o=="function"&&(a=o(a)),a.replaceAll(u)},persagyElement.prototype.eventHandout=function(e,t){var n=t.currentTarget,r=$(n),i=this.ptool.getInstanceFromDom(n),s=r.attr(this.ptool.libraryIdToHtml),o=i.constructor[s],u=o.event||{},a=t.type,f=u[a];return f?this.executeEventCall(e,t,f):null},persagyElement.prototype.executeEventCall=function(model,event,fnName){if(!fnName)return null;if(typeof fnName=="function")return model?fnName(model,event):fnName(event);var fn=eval(fnName);if(typeof fn=="function")return model?fn(model,event):fn(event)},persagyElement.getInstance=function(){return persagy_tool.instanceFactory(persagyElement)};var persagy_control={};void function(){function n(){$(function(){var n=$(document.body);t.createEvent(n,null,"DOMNodeInserted",function(n){function i(n){function h(t){var n=t.children();for(var r=0;r<n.length;r++){var s=n.eq(r);if(s.attr(e.maxDivMarker)!=null){i(s[0]);continue}arguments.callee(s)}}var r=$(n),s=e.getTypeAndChildTypeFromEle(n),o=s.controlType;h(r);var u=t.controlTypes;if(!u[o])return;var a=n[e.libraryToPro]||{};if(a[e.isRenderedToProName]===!0)return;if(r.attr(e.maxDivMarker)==null)return;var f=e.getInstanceFromDom(n),l=r.attr(e.libraryIdToHtml),c=f.constructor[l];f.rendered(n,c,s.childType),a=n[e.libraryToPro]||{},a[e.isRenderedToProName]=!0,n[e.libraryToPro]=a}var r=n.srcElement||n.target;i(r)}),t.createEvent(n,null,"click",function(){(new pcombobox).slideUp(),(new pcombobox).hideNotFirstLevelMenu();var n="",r=t.controlTypes.psearch.types,i=t.controlTypes.psearch.name;r.forEach(function(t){var r=i+e.typeSeparator+t;n+=(n.length>0?",":"")+"["+e.libraryTypeToHtml+'="'+r+'"]'}),$(n).find("["+(new psearch_template).friendlyMarker+"]").hide()}),t.createEvent(n,null,"mouseover",function(){(new pcombobox).hideNotFirstLevelMenu()}),$('script[type="text/html"],script[type="text/template"]').each(function(){var e=$(this),t="<div>"+e.html().replace(/\s+|\n/g," ").replace(/>\s</g,"><").ptrimHeadTail()+"</div>",n=$(t);n.prender(),e.html(n.html())}),n.find("["+e.persagyCreateType+"]").each(function(){var t=e.getTypeByPcreate(this);e.createControl(t.controlType,t.childType,this,null)}),$(document.body).prender()})}var e=persagy_tool.getInstance(),t=persagyElement.getInstance();n(),Object.freeze(persagy_control)}();(function(){function n(e,n){return function(e,n){return function(){var r=ptool.getDomElement(this),i=t.getInstanceFromDom(r);while(i===!1){r=$(r).children()[0];if(!r)break;i=t.getInstanceFromDom(r)}return!i&&typeof n!="function"?!1:i&&typeof i[e]=="function"?((new Array).unshift.call(arguments,r),i[e].apply(i,arguments)):typeof n=="function"?n.apply(this,arguments):!1}}(e,n)}function u(e,n){n.stopPropagation&&n.stopPropagation();var r=n.srcElement||n.target;n.srcElement=n.target=r;var i=n.currentTarget,s=t.getInstanceFromDom(i),o=0;while(!s){++o;if(o>100)break;i=$(i).parent()[0],s=t.getInstanceFromDom(i)}if(!s)return;n[t.eventCurrTargetName]=i,s.eventHandout(e,n)}var e=persagyElement.getInstance(),t=persagy_tool.getInstance(),r=e.extendFn;for(var i in r){if(r.hasOwnProperty(i)===!1)continue;var s=r[i],o=n(i,s);HTMLElement.prototype[i]=o,jQuery&&(jQuery.fn[i]=o)}window.model={},window[t.pbindEventFnName]=function(e,t){u(e,t)},window[t.pstaticEventFnName]=function(e){u(null,e)}})();function pbutton_template(){this.constructor=arguments.callee,this.start="<div "+this.ptool.maxDivMarker+' {{id}}{{disabled}}{{click}}{{mousedown}}{{mouseup}}{{mouseover}}{{mouseout}}{{mouseenter}}{{mouseleave}}{{mousewheel}} class="',this.textIconEnd='"><i {{icon}} class="per-bIcon"></i><em {{text}}{{title}}></em></div>',this.white=this.start+"per-button-grayBorder"+this.textIconEnd,this.blue=this.start+"per-button-grayBg"+this.textIconEnd,this.borderred=this.start+"per-button-redBorder"+this.textIconEnd,this.backred=this.start+"per-button-redBg"+this.textIconEnd,this.textEnd='"{{title}}><em {{text}}></em></div>',this.whiteText=this.start+"per-button-grayBorder"+this.textEnd,this.blueText=this.start+"per-button-grayBg"+this.textEnd,this.borderredText=this.start+"per-button-redBorder"+this.textEnd,this.backredText=this.start+"per-button-redBg"+this.textEnd,this.iconEnd='"{{title}}><i {{icon}}></i></div>',this.whiteIconRectangle=this.start+"per-squarebutton-grayBorder"+this.iconEnd,this.blueIconRectangle=this.start+"per-squarebutton-grayBg"+this.iconEnd,this.borderredIconRectangle=this.start+"per-squarebutton-redBorder"+this.iconEnd,this.backredIconRectangle=this.start+"per-squarebutton-redBg"+this.iconEnd,this.whiteIconEllipse=this.start+"per-iconbutton-grayBorder"+this.iconEnd,this.blueIconEllipse=this.start+"per-iconbutton-grayBg"+this.iconEnd,this.borderredIconEllipse=this.start+"per-iconbutton-redBorder"+this.iconEnd,this.backredIconEllipse=this.start+"per-iconbutton-redBg"+this.iconEnd,this.whiteNoBorder=this.start+"per-noBorderButton-white"+this.textIconEnd,this.blueNoBorder=this.start+"per-noBorderButton-gray"+this.textIconEnd,this.borderredNoBorder=this.backRedNoBorder=this.start+"per-noBorderButton-red"+this.textIconEnd,this.whiteTextNoBorder=this.start+"per-noBorderButton-white"+this.textEnd,this.blueTextNoBorder=this.start+"per-noBorderButton-gray"+this.textEnd,this.borderredTextNoBorder=this.backRedNoBorder=this.start+"per-noBorderButton-red"+this.textEnd,this.whiteIconNoBorder=this.start+"per-noBorderButton-white"+this.iconEnd,this.blueIconNoBorder=this.start+"per-noBorderButton-gray"+this.iconEnd,this.redIconNoBorder=this.start+"per-noBorderButton-red"+this.iconEnd}pbutton_template.prototype=new persagyElement;function pbutton(){this.constructor=arguments.callee}pbutton.prototype=new pbutton_template,pbutton.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css;if(e==this.controlTypes.pbutton.types[4]||e==this.controlTypes.pbutton.types[5])return(new pcombobox).init(e,t,n);r.isborder=r.isborder===!1?!1:!0,r.shape=r.shape||this.ptool.shape.rectangle;var o=e,u=r.text&&r.icon?"":r.text&&!r.icon?"Text":r.icon&&!r.text?"Icon":"",a=r.isborder==0?"NoBorder":r.text?"":r.icon&&r.shape===this.ptool.shape.rectangle?"Rectangle":r.icon&&r.shape===this.ptool.shape.ellipse?"Ellipse":"",f=o+u+a,l=this[f];this.renderView(l,this.controlTypes.pbutton.name,e,t,n)},pbutton.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e),o=s.find("em");o=o.length>0?o:s,s.registerEventForTitle(o,this.ptool.titleSourceAttr),r.isborder===!1?r.text&&r.icon?(s.registerEventForColorChange(s.find("i"),1),s.registerEventForColorChange(s.find("em"),1)):s.registerEventForColorChange(null,1):s.registerEventForColorChange(null,0);if(r.bind===!0)return;for(var u in i){if(i.hasOwnProperty(u)==0)continue;this.createEvent(s,this.controlTypes.pbutton.name,u,window[this.ptool.pstaticEventFnName])}};function pswitch_template(){this.constructor=arguments.callee,this.selCss={checkbox:"per-checkbox-checked",radio:"per-radio-checked",slide:"per-slide-checked"},this.start="<div "+this.ptool.maxDivMarker+' {{id}}{{title}}{{disabled}}{{click}}{{mousedown}}{{mouseup}}{{mouseover}}{{mouseout}}{{mouseenter}}{{mouseleave}} class="',this.checkbox=this.start+'per-switch-checkbox">',this.checkboxSpan1='<span class="per-checkbox_input',this.checkboxSpan2='"></span>',this.checkbox3='<span class="per-switch_label"{{text}}></span></div>',this.radio=this.start+'per-switch-radio"{{name}}>',this.radioSpan1='<span class="per-radio_input',this.radioSpan2='"></span>',this.radio3='<span class="per-switch_label" {{text}}></span></div>',this.slide=this.start+'per-switch-slide">',this.slideSpan1='<span class="per-slide-Bg',this.slideSpan2='"></span>',this.slide3='<span class="per-switch_round"></span></div>'}pswitch_template.prototype=new persagyElement,pswitch_template.prototype.getTemplateStr=function(e,t){var n=e.attr,r=this.selCss[t];if(n.bind!==!0){var i=n.state===!0?" "+r:"";return this[t]+this[t+"Span1"]+i+this[t+"Span2"]+this[t+"3"]}var s="",o=this[t+"Span1"]+this[t+"Span2"];if(n.state){var u={};u[r]=n.state,o=this.createStyleBind(o,u)}return this[t]+o+this[t+"3"]};function pswitch(){this.constructor=arguments.callee}pswitch.prototype=new pswitch_template,pswitch.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css||{},o=this.getTemplateStr(t,e);this.renderView(o,this.controlTypes.pswitch.name,e,t,n)},pswitch.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e);r.bind===!1&&this.createEvent(s,this.controlTypes.pswitch.name,"click",window[this.ptool.pstaticEventFnName]);var o=s.find("span:last");s.registerEventForTitle(o,this.ptool.titleSourceAttr),s.registerEventForColorChange(s.find("span:first"),0);if(r.bind===!0)return;for(var u in i){if(i.hasOwnProperty(u)==0)continue;if(u=="click")continue;this.createEvent(s,this.controlTypes.pswitch.name,u,window[this.ptool.pstaticEventFnName])}},pswitch.prototype.eventHandout=function(e,t){var n=t.currentTarget,r=$(n),i=r.attr(this.ptool.libraryIdToHtml),s=pswitch[i],o=s.attr,u=s.event||{},a=t.type,f=this.ptool.getTypeAndChildTypeFromEle(n),l=this.selCss[f.childType],c=r.find("span").eq(0),h=c.hasClass(l)?!0:!1;t=this.ptool.appendProToEvent(t,{state:h});if(a=="click"){var p=u.beforechange,d=!0;p&&(d=this.executeEventCall(e,t,p));if(d!==!1){var v=!0;f.childType==this.controlTypes.pswitch.types[1]&&(h==0?this.pgroupSelToClear(n):v=!1);if(v){this.psetSelState(n,c,l),h=c.hasClass(l)?!0:!1,t=this.ptool.appendProToEvent(t,{state:h}),e&&o.state&&(e[o.state]=h);var m=u.change;m&&this.executeEventCall(e,t,m)}}}var g=u[a];if(!g)return;this.executeEventCall(e,t,g)},pswitch.prototype.pgroupSelToClear=function(e){var t=ptool.getDomElement(e),n=this.ptool.getTypeAndChildTypeFromEle(t),r=this.selCss[n.childType],i=$(e).attr("name");$('[name="'+i+'"]').find("span").removeClass(r)},pswitch.prototype.psetSelState=function(e,t,n){e[pconst.targetHoverCssSourcePro]=[],t.css("backgroundColor",""),t.toggleClass(n)},pswitch.prototype.psel=function(e,t){var n=arguments[0],r=$(n),i=this.ptool.getTypeAndChildTypeFromEle(n),s=this.selCss[i.childType],o=r.find("span").eq(0),u=o.hasClass(s)?!0:!1;if(arguments.length==1)return u;e=arguments[1],t=arguments[2],t=t===!1?!1:!0;if(u===e)return u;if(t)return n.click();switch(e){case!0:i.childType==this.controlTypes.pswitch.types[1]&&this.pgroupSelToClear(n),this.psetSelState(n,o,s);break;case!1:if(i.childType==this.controlTypes.pswitch.types[1])return u;o.removeClass(s)}},pswitch.prototype.ptoggle=function(e){var t=arguments[0];e=arguments[1];var n=$(t),r=this.ptool.getTypeAndChildTypeFromEle(t),i=this.selCss[r.childType],s=n.find("span").eq(0),o=s.hasClass(i)?!1:!0;this.psel(t,o,e)};function pnotice_template(){this.constructor=arguments.callee,this.messCss={success:["per-notice-success","per-notice_successicon"],failure:["per-notice-failure","per-notice_failureicon"]},this.message="<div "+this.ptool.maxDivMarker+' class="per-notice-common" {{id}}><i>Z</i><em></em></div>',this.nodata="<div "+this.ptool.maxDivMarker+' {{id}} class="per-prompt-abnormalmess"><span class="per-prompt_icon"></span>'+'<span class="per-prompt_title" {{text}}></span><span class="per-prompt_subtitle" {{subtitle}}></span></div>'}pnotice_template.prototype=new persagyElement;function pnotice(){this.constructor=arguments.callee,this.timeoutTime=2e3,this.showCss={name:"margin-top",value:"0px"},this.hideCss={name:"margin-top",value:"-70px"}}pnotice.prototype=new pnotice_template,pnotice.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css||{},o=this[e];this.renderView(o,this.controlTypes.pnotice.name,e,t,n)},pnotice.prototype.rendered=function(e,t,n){},pnotice.prototype.pshow=function(e){if(arguments.length==1)return;var t=this,n=arguments[0];e=arguments[1]||{};var r=$(n),i=t.ptool.getTypeAndChildTypeFromEle(n);if(i.childType==t.controlTypes.pnotice.types[0]){var s=t.messCss[e.state||t.ptool.pcontrolState.success]||[],o=t.messCss[t.ptool.pcontrolState.success][0]+" "+t.messCss[t.ptool.pcontrolState.failure][0];r.removeClass(o),r.addClass(s[0]||""),o=t.messCss[t.ptool.pcontrolState.success][1]+" "+t.messCss[t.ptool.pcontrolState.failure][1];var u=r.find("i");u.removeClass(o),u.addClass(s[1]||""),r.find("em").text(e.text||"");var a=n[t.ptool.libraryToPro]||{},f=a[t.ptool.timerNameToElement];f&&clearTimeout(f),r.css(t.showCss.name,t.showCss.value),a[t.ptool.timerNameToElement]=setTimeout(function(){r.css(t.hideCss.name,t.hideCss.value)},t.timeoutTime)}else{var l=r.find("span");e.text&&l.eq(1).text(e.text),e.subTitle&&l.eq(2).text(e.subTitle),r.show()}},pnotice.prototype.phide=function(){var e=arguments[0],t=$(e),n=this.ptool.getTypeAndChildTypeFromEle(e);if(n.childType==this.controlTypes.pnotice.types[0])return;t.hide()};function ploading_template(){this.constructor=arguments.callee,this.global="<div "+this.ptool.maxDivMarker+' class="per-loading-overall" {{id}}><div class="loading-con">'+'<div class="per-loading-overall_pic"></div>'+'<div class="per-loading-overall_text" {{text}}></div></div></div>',this.part="<div "+this.ptool.maxDivMarker+' class="per-loading-nomal" {{id}}><div class="loading-con">'+'<div class="per-loading-nomal_pic"></div>'+'<div class="per-loading-nomal_text" {{text}}></div></div></div>'}ploading_template.prototype=new persagyElement;function ploading(){this.constructor=arguments.callee}ploading.prototype=new ploading_template,ploading.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css||{},o=this[e];this.renderView(o,this.controlTypes.ploading.name,e,t,n)},ploading.prototype.rendered=function(e,t,n){},ploading.prototype.pshow=function(e){var t=this,n=arguments[0];e=arguments[1];var r=$(n);e&&r.find("div").text(e),r.show()},ploading.prototype.phide=function(){var e=arguments[0],t=$(e);t.hide()};function pscroll_template(){this.constructor=arguments.callee,this.externalDivMarker="scrollmax",this.scrollDivMarker="scroll",this.scrollDivParentMarker="scrollparent",this.horizontalDivMarker="horizontal",this.horizontalBarMarker="horizontalbar",this.verticalDivMarker="vertical",this.verticalBarMarker="verticalbar",this.small="<div "+this.ptool.maxDivMarker+' class="per-scrollbar" '+this.externalDivMarker+'{{id}}><div class="per-scrollbar_wrap"'+this.scrollDivParentMarker+'><div class="per-scrollbar_actual" '+this.scrollDivMarker+"{{templateid}}></div></div>"+'<div class="per-scrollbar__bar per-is-horizontal" '+this.horizontalDivMarker+">"+'<div class="per-scrollbar__thumb" '+this.horizontalBarMarker+"></div></div>"+'<div class="per-scrollbar__bar per-is-vertical" '+this.verticalDivMarker+">"+'<div class="per-scrollbar__thumb" '+this.verticalBarMarker+"></div></div></div>"}pscroll_template.prototype=new persagyElement;function pscroll(){this.constructor=arguments.callee}pscroll.prototype=new pscroll_template,pscroll.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css||{};r.bind=!1;var o=this[e];this.renderView(o,this.controlTypes.pscroll.name,e,t,n)},pscroll.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e),o=s.find("["+this.scrollDivMarker+"]"),u=s.find("["+this.scrollDivParentMarker+"]"),a=s.find("["+this.horizontalDivMarker+"]"),f=s.find("["+this.verticalDivMarker+"]");this.createEvent(s,this.controlTypes.pscroll.name,"mouseenter",this.setEventCall(e)),this.createEvent(s,this.controlTypes.pscroll.name,"mouseleave",this.setEventCall(e)),this.createEvent(u,this.controlTypes.pscroll.name,"scroll",this.setEventCall(e)),this.createEvent(a,this.controlTypes.pscroll.name,"click",this.setEventCall(e)),this.createEvent(f,this.controlTypes.pscroll.name,"click",this.setEventCall(e))},pscroll.prototype.eventHandout=function(e,t){function E(){var e=0,n=0;if(w>0){e=l.scrollTop();var r=Math.division(e,y);r=Math.multiplication(r,100),d.css({transform:" translateY("+r+"%)"})}if(g>0){n=l.scrollLeft();var s=Math.division(n,v);s=Math.multiplication(s,100),h.css({transform:" translateX("+s+"%)"})}u.scroll&&(t=i.ptool.appendProToEvent(t,{maxScrollTop:w,currScrollTop:e,maxScrollLeft:g,scrollLeft:n}),i.executeEventCall(null,t,u.scroll))}var n=t.currentTarget,r=$(n),i=this;t.type=="mouseenter"&&(i.setClientSize(r),i.setScrollbarSize(r));var s=r.attr(i.ptool.libraryIdToHtml),o=pscroll[s],u=o.event||{},a=t.type,f=r.find("["+i.scrollDivMarker+"]"),l=r.find("["+i.scrollDivParentMarker+"]"),c=r.find("["+i.horizontalDivMarker+"]"),h=r.find("["+i.horizontalBarMarker+"]"),p=r.find("["+i.verticalDivMarker+"]"),d=r.find("["+i.verticalBarMarker+"]"),v=r.width(),m=f.width(),g=m-v,y=r.height(),b=f.height(),w=b-y;switch(a){case"scroll":i.setClientSize(r),i.setScrollbarSize(r),E();break;case"mouseenter":w>0&&p.show(),g>0&&c.show(),u.mouseenter&&i.executeEventCall(null,t,u.mouseenter);break;case"mouseleave":p.hide(),c.hide(),u.mouseleave&&i.executeEventCall(null,t,u.mouseleave),l.width(""),l.height("")}},pscroll.prototype.setEventCall=function(e){return function(e){return function(t){t.stopPropagation&&t.stopPropagation(),t.currentTarget=e,window[persagy_tool.getInstance().pstaticEventFnName](t)}}(e)},pscroll.prototype.psetScroll=function(e,t){var n=arguments[0];e=arguments[1],t=arguments[2]||this.ptool.arrangeType.vertical;var r=$(n),i=r.find("["+this.scrollDivParentMarker+"]"),s=t==this.ptool.arrangeType.vertical?"scrollTop":"scrollLeft";i[s](e)},pscroll.prototype.setClientSize=function(e){var t=e.find("["+this.scrollDivParentMarker+"]"),n=e.width(),r=e.height(),i=17,s=t.width(),o=t.height();if(s-n!=i||o-r!=i)t.width(n+i),t.height(r+i)},pscroll.prototype.setScrollbarSize=function(e){var t=e.find("["+this.scrollDivMarker+"]"),n=e.find("["+this.horizontalBarMarker+"]"),r=e.find("["+this.verticalBarMarker+"]"),i=e.width(),s=e.height(),o=t.height(),u=t.width(),a=e[0][this.ptool.libraryToPro]||{};a[this.ptool.controlPrivateToProName]=!1;if(o>s||u>i){a[this.ptool.controlPrivateToProName]=!0;var f=Math.division(s,o);f=Math.multiplication(f,100);var l=Math.division(i,u);l=Math.multiplication(l,100),r.height(f+"%"),n.width(l+"%")}e[0][this.ptool.libraryToPro]=a};function ptext_template(){this.constructor=arguments.callee,this.errMarker="err",this.errTextMarker="errtext",this.friendlyMarker="friendly",this.textMarker="text",this.currCharLengthMarker="charlength",this.errCss="input-error",this.start="<div "+this.ptool.maxDivMarker+' {{id}}{{disabled}} class="',this.basicTextStart='"><input type="text" '+this.textMarker+"{{placeholder}}{{value}}{{focus}}{{blur}}{{click}}{{mousedown}}{{mouseup}}{{mouseover}}{{mouseout}}>",this.unitTextStart='"><div{{text}} class="',this.unitTextStart2='"></div><div class="',this.unitTextStart3='"><input type="text" '+this.textMarker+'{{placeholder}}{{value}}{{focus}}{{blur}}{{click}}{{mousedown}}{{mouseup}}{{mouseover}}{{mouseout}}><div class="per-inputborder"></div></div>',this.textareaStart='"><div class="per-input-textarea"><div class="textareawrap ',this.textareaStart2='"><textarea '+this.textMarker+"{{placeholder}}{{value}}{{focus}}{{blur}}{{click}}{{mousedown}}{{mouseup}}{{mouseover}}{{mouseout}}></textarea>"+'<div class="per-textareaborder"></div>',this.textareaStart3='<div class="per-textarea-length"><b '+this.currCharLengthMarker+">0</b>/<b {{text}}></b></div>",this.end="/div>",this.end2='<div class="reminder-tip" '+this.friendlyMarker+"><i>*</i><em {{text}}></em></div>",this.end3='<div class="error-tip" '+this.errMarker+"><i>！</i><em "+this.errTextMarker+"></em></div></div>",this.noUnitStartClass="per-input-basic",this.unitStartClass="per-input-unit",this.textareaStartClass="per-input-textarea",this.unitLeftTextStartClass="per-inputunitL",this.unitRightTextStartClass="per-inputunit",this.unitLeftTextStartClass2="per-inputwrapR",this.unitRightTextStartClass2="per-inputwrap",this.textareaLengthStartClass="",this.textareaNoLengthStartClass="per-textareawra-nolength"}ptext_template.prototype=new persagyElement,ptext_template.prototype.getTemplateStr=function(e,t){var n=e.attr,r=n.bind,i=n.friendly||{},s=n.text,o=n.align||this.ptool.align.right,u=n.maxLength,a=this.start+(t===this.controlTypes.ptext.types[1]?this.textareaStartClass:s?this.unitStartClass:this.noUnitStartClass),f="";switch(t){case this.controlTypes.ptext.types[0]:s?f=this.unitTextStart+(o==this.ptool.align.right?this.unitRightTextStartClass:this.unitLeftTextStartClass)+this.unitTextStart2+(o==this.ptool.align.right?this.unitRightTextStartClass2:this.unitLeftTextStartClass2)+this.unitTextStart3:f=this.basicTextStart;break;case this.controlTypes.ptext.types[1]:f=this.textareaStart+(u?this.textareaLengthStartClass:this.textareaNoLengthStartClass)+this.textareaStart2+(u?this.textareaStart3:""),u&&(n.text=u)}var l=t===this.controlTypes.ptext.types[0]&&s?this.end:"",c=this.end2,h=this.end3,p=r===!0?"joinHtmlToBindByAttrCss":"joinHtmlByAttrCss";return a=this[p](a,n),f=this[p](f,n,e.event),c=this[p](c,{text:i.info}),a+f+c+h};function ptext(){this.constructor=arguments.callee}ptext.prototype=new ptext_template,ptext.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css,o=n.find("tip");r.friendly={info:o.attr("friendlytip")};var u=n.find("verify"),a=[];for(var f=0;f<u.length;f++){var l=u.eq(f),c=l.attr("length");a.push({verifytype:l.attr("verifytype"),length:c,errtip:l.attr("errtip")}),c&&(r.maxLength=parseInt(c))}r.verify=a;if(e==this.controlTypes.ptext.types[2])return(new pcombobox).init(this.controlTypes.pcombobox.types[4],t,n);var h=this.getTemplateStr(t,e);this.renderView(h,this.controlTypes.ptext.name,e,t,n)},ptext.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e),o=s.find("["+this.textMarker+"]");i.blur||this.createEvent(o,this.controlTypes.ptext.name,"blur",window[this.ptool.pstaticEventFnName]),i.focus||this.createEvent(o,this.controlTypes.ptext.name,"focus",window[this.ptool.pstaticEventFnName]),!i.input&&n===this.controlTypes.ptext.types[1]&&r.maxLength&&this.createEvent(o,this.controlTypes.ptext.name,"input",window[this.ptool.pstaticEventFnName]);if(r.bind===!0)return;for(var u in i){if(i.hasOwnProperty(u)==0)continue;this.createEvent(o,this.controlTypes.ptext.name,u,window[this.ptool.pstaticEventFnName])}},ptext.prototype.eventHandout=function(e,t){var n=t[this.ptool.eventCurrTargetName],r=$(n),i=r.attr(this.ptool.libraryIdToHtml),s=this.ptool.getTypeAndChildTypeFromEle(n),o=ptext[i],u=o.attr,a=u.verify||[],f=u.friendly||{},l=o.event,c=t.type,h=l[c],p=r.find("["+this.errMarker+"]"),d=r.find("["+this.friendlyMarker+"]"),v=r.find("["+this.textMarker+"]"),m=v.val();switch(c){case"focus":r.phideTextTip(),f.info&&d.show();break;case"blur":d.hide();var g=r.pverifi();g?(p.hide(),v.removeClass(this.errCss)):(p.show(),v.addClass(this.errCss));break;case"input":s.childType===this.controlTypes.ptext.types[1]&&u.maxLength&&r.find("["+this.currCharLengthMarker+"]").text(m.length)}this.executeEventCall(e,t,h)},ptext.prototype.pval=function(e){var t=arguments[0],n=$(t);e=arguments[1];var r=n.find("["+this.textMarker+"]");if(e==null)return r.val();r.val(e)},ptext.prototype.precover=function(){var e=arguments[0],t=$(e);t.pval(""),t.phideTextTip()};function pcombobox_template(){this.ptextTemplate=new ptext,this.constructor=arguments.callee,this.headerSplitor=" / ",this.comboxMaxHeight=212,this.headerTextMarker="cheadertext",this.headerIconMarker="cheadericon",this.headerMarkder="cheader",this.contentMaxDivMarker="con",this.contentFlexDivMarker="flex",this.comboxConMarker="cobcon",this.contentUlMarker="conul",this.levelMarker="level",this.selCss="per-pitch",this.basicHeaderClassName="per-combobox-title",this.noborderHeaderClassName="per-nobordercombobox-title",this.menuHeaderClassName="per-combobox-button",this.pageComboboxTitleClassName="per-paging-combobox_title",this.orientationCss={up:"_combobox_top",down:"_combobox_bottom"},this.alignCss={left:"_combobox_left",right:"_combobox_right"},this.contentExtenDivStart='<div class="per-combobox-wrap',this.contentExtenDivStart2='" style="display: none;" '+this.contentMaxDivMarker+'><div class="_combobox_flex" '+this.contentFlexDivMarker+">",this.contentDivStartStr1='<div class="per-combobox-con " style="display: inline-block;" '+this.comboxConMarker+" "+this.levelMarker+'="',this.contentDivStartStr2=">",this.contentDivEndStr="</div>",this.contentUlStartStr="<ul "+this.contentUlMarker+">",this.contentUlEndStr="</ul>",this.itemTemplateStr1='<li class="per-combobox_item ',this.itemLiTemplateStr2_='" '+this.levelMarker+'="',this.itemLiTemplateStr2=">",this.itemIconTemplateStr='<span class="per-combobox_item_icon"{{text}}></span>',this.itemTextTemplateStr="<b {{text}}></b>",this.itemTemplateStr2='<i class="',this.itemTemplateStr4=">",this.itemTemplateStr3="</i></li>",this.start="<div "+this.ptool.maxDivMarker+' class="per-combobox-basic',this.end1='" {{id}}{{disabled}}><div ',this.end3=this.headerMarkder+' class="',this.endMiddle='"><span class="',this.endMiddle4='" '+this.headerTextMarker,this.endMiddle5='></span><span class="',this.endMiddle2='">',this.endMiddle3="</span></div>",this.errStr='<div class="error-tip" '+this.ptextTemplate.errMarker+"><i>！</i><em "+this.ptextTemplate.errTextMarker+"{{text}}></em></div>",this.tipStr="",this.end2="</div></div>",this.end2_="</div>",this.selIcon={sel:"Z",nextItem:">"},this.itemTemplateClass={Z:"per-combobox_item_iconR",">":"per-combobox_level_iconR"}}pcombobox_template.prototype=new persagyElement,pcombobox_template.prototype.getTemplateStr=function(childType,objBind){var attr=objBind.attr,itemObj=attr.item,verifyObj=attr.verify,headerObj=attr.header,friendlyObj=attr.friendly,itemTextName=itemObj.text||"",itemIconName=itemObj.icon||"",isSelToProName=itemObj.pronametoissel,childProName=itemObj.child,conItemStr="",iconStr="",textStr="",selIcon="",itemSourceStr=itemObj.datasource,end2=this.end2,errStr=this.errStr,tipStr=this.tipStr,contentExtenDivStart=this.contentExtenDivStart,contentMaxDivCss=" "+this.orientationCss[attr.orientation]+" "+this.alignCss[attr.align];contentExtenDivStart+=contentMaxDivCss+" "+this.contentExtenDivStart2;var endMiddle4=this.endMiddle4;endMiddle4=attr.bind==1?this.joinHtmlToBindByAttrCss(endMiddle4,{placeholder:headerObj.placeholder}):this.joinHtmlByAttrCss(endMiddle4,{placeholder:headerObj.placeholder});var end1=this.end1,endMiddle=this.endMiddle;end1+=(childType==this.controlTypes.pcombobox.types[2]?"":"{{click}}")+this.end3,endMiddle+=childType==this.controlTypes.pcombobox.types[2]?"per-comboboxButton_name":"per-combobox_name",endMiddle+=endMiddle4+(childType==this.controlTypes.pcombobox.types[2]?"{{click}}":"")+this.endMiddle5,endMiddle+=childType==this.controlTypes.pcombobox.types[2]?"per-comboboxButton_icon":"per-combobox_icon",endMiddle+=this.endMiddle2+(childType==this.controlTypes.pcombobox.types[2]?"b":childType==this.controlTypes.pcombobox.types[5]?"":"v")+this.endMiddle3,endMiddle+=contentExtenDivStart;var ptStr=" "+this.ptool.libraryTypeToHtml+'="'+this.controlTypes.pcombobox.name+this.ptool.typeSeparator+childType+'"',selIcon,itemTemplateStr2=this.itemTemplateStr2;if(attr.bind!==!0){end1=this.joinHtmlByAttrCss(end1,{id:attr.id,disabled:attr.disabled}),endMiddle=this.joinHtmlByAttrCss(endMiddle);var itemsArr=eval(itemSourceStr)||[];conItemStr=this.joinLi(itemsArr,objBind,childType,1),errStr=this.joinHtmlByAttrCss(errStr,{text:verifyObj.errtip}),tipStr=this.joinHtmlByAttrCss(tipStr,{text:friendlyObj.info})}else{errStr=this.joinHtmlToBindByAttrCss(errStr,{text:verifyObj.errtip}),tipStr=this.joinHtmlToBindByAttrCss(tipStr,{text:friendlyObj.info}),end1=this.joinHtmlToBindByAttrCss(end1,{id:attr.id,disabled:attr.disabled}),endMiddle=this.joinHtmlToBindByAttrCss(endMiddle);if(childType!==this.controlTypes.pcombobox.types[0]&&childType!==this.controlTypes.pcombobox.types[4])selIcon="",itemTemplateStr2+='"',attr.istree=!1;else if(attr.istree===!1)selIcon=this.selIcon.sel,itemTemplateStr2+=this.itemTemplateClass[selIcon]+'"';else{selIcon="";var bindCssObj={};bindCssObj[this.itemTemplateClass[this.selIcon.sel]]="model."+isSelToProName,bindCssObj[this.itemTemplateClass[this.selIcon.nextItem]]="model."+childProName+"&&model."+childProName+".length>0",itemTemplateStr2=this.joinHtmlToBindByAttrCss(itemTemplateStr2+'"'+"{{text}}{{"+this.itemTemplateClass[this.selIcon.sel]+"}}{{"+this.itemTemplateClass[this.selIcon.nextItem]+"}}"+this.itemTemplateStr4,{text:"model."+isSelToProName+"==true?'"+this.selIcon.sel+"':model."+childProName+"&&model."+childProName+".length>0?'"+this.selIcon.nextItem+"':''"},{},bindCssObj)}iconStr=itemIconName?this.joinHtmlToBindByAttrCss(this.itemIconTemplateStr,{text:itemIconName},{},{}):"",textStr=this.joinHtmlToBindByAttrCss(this.itemTextTemplateStr,{text:itemTextName},{},{},!0),conItemStr=this.itemTemplateStr1+this.itemLiTemplateStr2_+'1"{{click}}'+(attr.istree===!0&&childType===this.controlTypes.pcombobox.types[0]?"{{mouseenter}}":"")+this.itemLiTemplateStr2+iconStr+textStr+itemTemplateStr2+(attr.istree===!0?"":this.itemTemplateStr4)+selIcon+this.itemTemplateStr3,conItemStr=this.joinHtmlToBindByAttrCss(conItemStr,{},{},{}),conItemStr=this.createForBind(conItemStr,itemSourceStr)}var templateStartStr=this.start+end1,headerClassName=childType==this.controlTypes.pcombobox.types[5]?this.pageComboboxTitleClassName:childType==this.controlTypes.pcombobox.types[2]?this.menuHeaderClassName:childType!=this.controlTypes.pcombobox.types[0]&&childType!=this.controlTypes.pcombobox.types[6]||attr.isborder!==!1?this.basicHeaderClassName:this.noborderHeaderClassName,three=this.createDownList(conItemStr,1);end2+=errStr+tipStr+this.end2_;switch(childType){case this.controlTypes.pcombobox.types[1]:return templateStartStr+headerClassName+endMiddle+this.contentDivStartStr1+'1"{{templateid}}'+this.contentDivStartStr2+this.contentDivEndStr+end2;case this.controlTypes.pcombobox.types[4]:var valueStr='<input type="text"{{value}}{{placeholder}} '+this.ptextTemplate.textMarker+'><div class="per-inputborder"></div></div></div>';return valueStr=attr.bind==1?this.joinHtmlToBindByAttrCss(valueStr,{value:attr.value,placeholder:headerObj.placeholder}):this.joinHtmlByAttrCss(valueStr,{value:attr.value,placeholder:headerObj.placeholder}),'<div class="per-input-select" '+this.ptool.maxDivMarker+'><div class="per-inputcombobox-title" '+this.headerMarkder+">"+'<div class="per-inputIcon" '+this.headerIconMarker+'>b</div><div class="per-inputwrap">'+valueStr+contentExtenDivStart+three+"</div></div>"+errStr+tipStr+"</div>";default:return templateStartStr+headerClassName+endMiddle+three+end2}},pcombobox_template.prototype.joinLi=function(e,t,n,r,i){var s=t.attr||{},o=s.item||{},u=s.header||{},a=o.step,f=o.text||"",l=o.icon||"",c=o.pronametoissel,h=o.child,p="",d=n===this.controlTypes.pcombobox.types[5]?s.number||1:n===this.controlTypes.pcombobox.types[6]?o.end+1:e.length,v=n===this.controlTypes.pcombobox.types[6]?o.start:0;for(v;v<d;v++){var m=e[v],g="";switch(n){case this.controlTypes.pcombobox.types[5]:g=v+1;break;case this.controlTypes.pcombobox.types[6]:a?g=v+"~"+(v+a-1):(g=v,g=g<10?"0"+g:g,g+=u.prefix||"");break;default:g=m[f]||""}var y=l?this.joinHtmlByAttrCss(this.itemIconTemplateStr,{text:m[l]||""},{}):"",b=this.joinHtmlByAttrCss(this.itemTextTemplateStr,{text:g},{}),w=n!==this.controlTypes.pcombobox.types[0]&&n!==this.controlTypes.pcombobox.types[4]?"":s.istree===!1?this.selIcon.sel:m[c]===!0?this.selIcon.sel:m[h]&&m[h].length>0?this.selIcon.nextItem:"",E=(this.itemTemplateClass[w]||"")+'"';p+=this.itemTemplateStr1+(i?i==m[f]?this.selCss:"":"")+this.itemLiTemplateStr2_+r+'"'+this.itemLiTemplateStr2+y+b+this.itemTemplateStr2+E+this.itemTemplateStr4+w+this.itemTemplateStr3,n===this.controlTypes.pcombobox.types[6]&&a&&(v=v+a-1)}return p},pcombobox_template.prototype.createDownList=function(e,t){var n=this.contentUlStartStr+e+this.contentUlEndStr,r=this.ptool.createDynamicTemplate(n),i=$('<div><pscroll-small templateid="'+r+'"></pscroll-small></div></div>');return n=i.html(),this.contentDivStartStr1+t+'"'+this.contentDivStartStr2+n+this.contentDivEndStr},pcombobox_template.prototype.joliToTime=function(e,t,n){var r="";for(var i=e;i<=t;i++){var s=(i<10?"0"+i:i)+(n||""),o=this.itemTemplateStr1+'"'+this.itemLiTemplateStr2+this.itemTextTemplateStr+this.itemTemplateStr2+'"'+this.itemTemplateStr4+this.itemTemplateStr3;o=this.joinHtmlByAttrCss(o,{text:s}),r+=o}return r};function pcombobox(){this.constructor=arguments.callee}pcombobox.prototype=new pcombobox_template,pcombobox.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css;r.number=r.number||1;var o=n.find("header");r.header={placeholder:e===this.controlTypes.pcombobox.types[5]?1+this.headerSplitor+(r.number||1):o.attr("placeholder"),prefix:o.attr("prefix"),click:o.attr("click")};var u=n.find("item");r.item={datasource:u.attr("datasource"),text:u.attr("text"),icon:u.attr("icon"),child:u.attr("child"),pronametoissel:u.attr("pronametoissel"),start:parseInt(u.attr("start"))||0,end:parseInt(u.attr("end"))||0,step:parseInt(u.attr("step"))||0};var a=n.find("verify");r.verify={verifytype:a.attr("verifytype"),errtip:a.attr("errtip"),friendlytip:a.attr("friendlytip")};var f=n.find("tip");r.friendly={info:f.attr("friendlytip")},r.isborder=r.isborder===!1?!1:!0,r.istree=r.istree===!0?!0:!1,r.orientation=r.orientation?r.orientation:this.ptool.orientation.down,r.align=r.align?r.align:this.ptool.align.left;var l=this.getTemplateStr(e,t),c=this.renderView(l,this.controlTypes.pcombobox.name,e,t,n)},pcombobox.prototype.rendered=function(element,objBind){if(!objBind)return;var attr=objBind.attr,event=objBind.event,jqElement=ptool.getJqElement(element),typeObj=this.ptool.getTypeAndChildTypeFromEle(jqElement),headerJqEle=jqElement.find("["+this.headerMarkder+"]");attr.header.placeholder&&jqElement.find("["+this.headerTextMarker+"]").text(attr.header.placeholder),attr.bind!==!0&&(typeObj.childType!==this.controlTypes.pcombobox.types[2]&&typeObj.childType!==this.controlTypes.pcombobox.types[4]?this.createEvent(headerJqEle,this.controlTypes.pcombobox.name,"click",window[this.ptool.pstaticEventFnName]):this.createEvent(headerJqEle.find("span:first"),this.controlTypes.pcombobox.name,"click",window[this.ptool.pstaticEventFnName]));switch(typeObj.childType){case this.controlTypes.pcombobox.types[2]:this.createEvent(headerJqEle.find("span:last"),this.controlTypes.pcombobox.name,"click",window[this.ptool.pstaticEventFnName]);break;case this.controlTypes.pcombobox.types[4]:this.createEvent(headerJqEle.find("["+this.headerIconMarker+"]"),this.controlTypes.pcombobox.name,"click",window[this.ptool.pstaticEventFnName])}if(typeObj.childType==this.controlTypes.pcombobox.types[1])return;if(typeObj.childType===this.controlTypes.pcombobox.types[4]){var inputTarget=jqElement.find("["+this.ptextTemplate.textMarker+"]");(!event.blur||attr.bind!=1)&&this.createEvent(inputTarget,this.controlTypes.pcombobox.name,"blur",window[this.ptool.pstaticEventFnName]),(!event.focus||attr.bind!=1)&&this.createEvent(inputTarget,this.controlTypes.pcombobox.name,"focus",window[this.ptool.pstaticEventFnName])}this.setScrollSize(jqElement);var itemObj=attr.item,itemSourceStr=itemObj.datasource,itemsArr=attr.bind===!0?[]:eval(itemSourceStr)||[],_id=jqElement.attr(this.ptool.libraryIdToHtml),ulJqTarget=jqElement.find("["+this.contentUlMarker+"]");this.conUlSet(ulJqTarget,_id,itemsArr,!attr.bind,jqElement.find("["+this.comboxConMarker+"]["+this.levelMarker+"]"),typeObj.childType)},pcombobox.prototype.headerClick=function(e){var t=$(e.currentTarget);if(e.currentTarget.tagName=="SPAN"||$(e.currentTarget).attr(this.headerIconMarker)=="")t=t.parent();var n=t.next(),r=$("["+this.contentMaxDivMarker+"]").not(n).slideUp(200);n.toggle(200)},pcombobox.prototype.eventHandout=function(e,t){if(t.type!=="mouseover"){var n=t.currentTarget,r=$(n),i=$(t[this.ptool.eventCurrTargetName]),s=i.attr(this.ptool.libraryIdToHtml),o=pcombobox[s],u=o.attr,a=u.header.prefix||"",f=this.ptool.getTypeAndChildTypeFromEle(i);if(n.tagName=="LI"){var l=$(t.target);l[0].tagName!="LI"&&(l=l.parent());var c=l[0],h=l.parent(),p=h.parents("["+this.ptool.libraryIdToHtml+'="'+s+'"]').eq(0);t[this.ptool.eventCurrTargetName]=p[0];var d=p.find("["+this.headerTextMarker+"]").text();a&&(d=d.substr(a.length));var v=l.index(),m=parseInt(l.attr(this.levelMarker)||1),g=m+1,y="["+this.comboxConMarker+"]["+this.levelMarker+'="'+g+'"]',b=u.bind===!0&&m===1?e||{}:(h[0][this.ptool.libraryToPro][this.ptool.controlPrivateToProName]||[])[v]||{};e=u.bind===!0?b:e;var w=b[u.item.child]||[]}switch(t.type){case"focus":case"blur":return ptext[s]=o,this.ptextTemplate.eventHandout(e,t);case"click":var E=u.header.click;if(r.attr(this.headerMarkder)==""){this.executeEventCall(e,t,E),this.headerClick(t);return}if(r.attr(this.headerTextMarker)==""){this.executeEventCall(e,t,E);return}if(n.tagName=="SPAN"&&r.attr(this.headerTextMarker)==null)return this.headerClick(t);if(r.attr(this.headerIconMarker)=="")return this.headerClick(t);if(u.istree===!0&&b[u.item.pronametoissel]!==!0)return;t[this.ptool.eventOthAttribute]={index:v,currItem:b},(f.childType===this.controlTypes.pcombobox.types[0]||f.childType===this.controlTypes.pcombobox.types[4]||f.childType===this.controlTypes.pcombobox.types[5]||f.childType===this.controlTypes.pcombobox.types[6])&&(u.istree!==!0||b[u.item.pronametoissel]==1)&&this.changeSelItem(p,l,o,f.childType);if(!p.find("["+this.contentMaxDivMarker+"]").is(":hidden")){var S=p.find("["+this.headerMarkder+"]");S[0].click()}var x=o.event.sel,T=o.event.beforesel;if(T){var N=this.executeEventCall(e,t,T);if(N===!1)return}this.executeEventCall(e,t,x);break;case"mouseenter":if(n.tagName=="LI"){var C=h.parent().parent().parent()[0];(new pscroll).setEventCall(C)({type:"mouseenter"})}if(u.istree===!1)return;var k=g+1,L=p.find("["+this.comboxConMarker+"]["+this.levelMarker+'="'+k+'"]');while(L.length>0)L.hide(),k+=1,L=p.find("["+this.comboxConMarker+"]["+this.levelMarker+'="'+k+'"]');var A=p.find(y);if(w&&w.length>0){var O=this.joinLi(w,o,f.childType,g,d);if(A.length>0){var M=A.find("["+this.contentUlMarker+"]");M.empty(),M.append(O)}else{var _="["+(new pscroll_template).externalDivMarker+"]",D=p.find(_+":first").width();p.find("["+this.contentMaxDivMarker+"]").width(D);var P=this.createDownList(O,g);p.find("["+this.contentFlexDivMarker+"]").append(P),this.setScrollSize(p),p.prender(),A=p.find(y)}this.conUlSet(A.find("["+this.contentUlMarker+"]"),s,w,!0,A,f.childType),A.show()}else A.hide()}}},pcombobox.prototype.psel=function(e,t){var n=arguments[0],r=$(n),i=r.attr(this.ptool.libraryIdToHtml),s=this.ptool.getTypeAndChildTypeFromEle(r),o=pcombobox[i],u=o.attr,a=u.header.prefix||"";arguments.length>1?(e=arguments[1],t=arguments[2]):(e=s.childType==this.controlTypes.pcombobox.types[4]?r.find("["+this.ptextTemplate.textMarker+"]").val():r.find("["+this.headerTextMarker+"]").text(),a&&s.childType!==this.controlTypes.pcombobox.types[6]&&(e=e.substr(a.length)),t=!1),t=t===!1?!1:!0;var f=r.find("["+this.contentUlMarker+"]").children(),l,c;for(var h=0;h<f.length;h++){var p=f.eq(h),d=p.find("b").text();if(h===e||d===e){e=d,l=f.eq(h),c=h;break}}return l?(t?l[0].click():this.changeSelItem(r,l,o,s.childType),{index:c,text:e}):!1},pcombobox.prototype.precover=function(e){var t=arguments[0],n=$(t),r=this.ptool.getTypeAndChildTypeFromEle(n);switch(r.childType){case this.controlTypes.pcombobox.types[4]:n.find("["+this.ptextTemplate.textMarker+"]").val("");break;case this.controlTypes.pcombobox.types[0]:var i=n.attr(this.ptool.libraryIdToHtml),s=pcombobox[i],o=s.attr;if(o.istree===!1){var u=n.psel().index;n.find("["+this.contentUlMarker+"]").children().eq(u).removeClass(this.selCss)}var a=o.header;e=o.bind!==!0?a.placeholder||"":arguments[1]||"",n.find("["+this.headerTextMarker+"]").text(e)}n.phideTextTip()},pcombobox.prototype.pval=function(e){var t=arguments[0],n=$(t);e=arguments[1];var r=this.ptool.getTypeAndChildTypeFromEle(n);return r.childType===this.controlTypes.pcombobox.types[4]?(new ptext).pval(t,e):!1},pcombobox.prototype.changeSelItem=function(e,t,n,r){var i=n.attr.header.prefix||"",s=t.find("b").text();if(r!==this.controlTypes.pcombobox.types[4]){r===this.controlTypes.pcombobox.types[6]?s=s:s=i+s,r===this.controlTypes.pcombobox.types[5]&&(s=s+this.headerSplitor+n.attr.number),e.find("["+this.headerTextMarker+"]").text(s);var o=e.find("["+this.contentUlMarker+"]");for(var u=0;u<o.length;u++)o.eq(u).find("li").removeClass(this.selCss);t.addClass(this.selCss)}else e.find("["+this.ptextTemplate.textMarker+"]").val(s)},pcombobox.prototype.setScrollSize=function(e){var t=e.find("["+this.headerMarkder+"]"),n=t.width(),r="["+this.ptool.libraryTypeToHtml+'="'+this.controlTypes.pscroll.name+this.ptool.typeSeparator+this.controlTypes.pscroll.types[0]+'"]';e.find(r).css({"min-width":n+"px","max-height":this.comboxMaxHeight+"px"})},pcombobox.prototype.conUlSet=function(e,t,n,r,i,s){var o=this,u=this.controlTypes.pcombobox.name+this.ptool.typeSeparator+s;e.attr(o.ptool.libraryIdToHtml,t),e.attr(o.ptool.libraryTypeToHtml,u),o.createEvent(i,o.controlTypes.pcombobox.name,"mouseover",window[o.ptool.pstaticEventFnName]);if(r){var a=e[0],f=a[o.ptool.libraryToPro]||{};f[o.ptool.controlPrivateToProName]=n,a[o.ptool.libraryToPro]=f,o.conliEvent(e)}},pcombobox.prototype.conliEvent=function(e){var t=this,n=e.find("li");n.each(function(){t.createEvent(this,t.controlTypes.pcombobox.name,"mouseenter",window[t.ptool.pstaticEventFnName]),t.createEvent(this,t.controlTypes.pcombobox.name,"click",window[t.ptool.pstaticEventFnName])})},pcombobox.prototype.slideUp=function(){var e=this,t="",n=e.controlTypes.pcombobox.types;n.forEach(function(n){var r=e.ptool.libraryTypeToHtml+'="'+e.controlTypes.pcombobox.name+e.ptool.typeSeparator+n+'"';t+=(t.length==0?"":",")+"["+r+"]"}),$(t).find("["+e.contentMaxDivMarker+"]").slideUp(200)},pcombobox.prototype.hideNotFirstLevelMenu=function(){var e=this,t="",n=e.controlTypes.pcombobox.types;n.forEach(function(n){var r=e.ptool.libraryTypeToHtml+'="'+e.controlTypes.pcombobox.name+e.ptool.typeSeparator+n+'"';t+=(t.length==0?"":",")+"["+r+"]"});var r=$(t);r.each(function(){var t="["+e.comboxConMarker+"]["+e.levelMarker+'!="1"]';$(this).find(t).hide()})},pcombobox.prototype.pcount=function(e){var t=arguments[0],n=$(t),r=n.attr(this.ptool.libraryIdToHtml),i=pcombobox[r],s=i.attr;e=arguments[1],s.number=e,i.attr=s,pcombobox[r]=i;var o=n.find("["+this.contentUlMarker+"]"),u=this.joinLi([],i,this.controlTypes.pcombobox.types[5],1);o.empty(),o.append(u),this.conliEvent(o)},pcombobox.prototype.resetList=function(e,t,n,r){var i=this.joliToTime(t,n,r),s=e.attr(this.ptool.libraryIdToHtml),o=e.find("["+this.ptool.libraryIdToHtml+'="'+s+'"]');o.empty(),o.append(i),this.conliEvent(o)},pcombobox.prototype.setHeaderText=function(e,t){e.find("["+this.headerTextMarker+"]").text(t)};function ptab_template(){this.constructor=arguments.callee,this.leftMarker="left",this.rightMarker="right",this.clientPadding=10,this.contentTagMarker="ulm",this.contentLiMarker="ctli",this.selCss={button:"per-tab-button_active",text:"per-tab-text_active",navigation:"active"},this.buttonStart="<div "+this.ptool.maxDivMarker+' class="per-tab-button"{{id}}><ul '+this.contentTagMarker+">",this.buttonItem='<li class="per-tab-button_item"{{disabled}}{{click}}><span class="per-tab-button_nav"{{text}}></span></li>',this.buttonEnd="</ul></div>",this.textStart="<div "+this.ptool.maxDivMarker+' class="per-tab-text"{{id}}><div class="per-tab-text_but _tab-text-left" '+this.leftMarker+'="'+this.leftMarker+'" disable="flase"><</div><div class="per-tab-text_wrap"><ul '+this.contentTagMarker+">",this.textItem='<li class="per-tab-text_item"{{text}}{{disabled}}{{click}}></li>',this.textEnd='</ul></div><div class="per-tab-text_but _tab-text-right" '+this.rightMarker+'="'+this.rightMarker+'" disable="flase">></div></div>',this.navigationStart="<div "+this.ptool.maxDivMarker+' class="per-tab-navigation" {{id}}><div class="per-tab-navigation_title"><ul '+this.contentTagMarker+">",this.navigationIcon='<i class="per-tab-navigation_icon"{{icon}}></i>',this.navigationItem='<li class="per-tab-navigation_item"{{disabled}}{{click}}>',this.navigationItemEnd="<em {{text}}></em></li>",this.navigationEnd='</ul></div><div class="per-tab-navigation_con" {{templateid}}></div></div>'}ptab_template.prototype=new persagyElement,ptab_template.prototype.joinLi=function(objBind,childType){var attr=objBind.attr,bind=attr.bind,datasource=attr.datasource,text=attr.text,icon=attr.icon,disabled=attr.disabled,conTemplateStr=childType==this.controlTypes.ptab.types[0]?this.buttonItem:childType==this.controlTypes.ptab.types[1]?this.textItem:childType==this.controlTypes.ptab.types[2]?this.navigationItem:"";childType===this.controlTypes.ptab.types[2]&&(conTemplateStr+=(icon?this.navigationIcon:"")+this.navigationItemEnd);var conItemStr="";if(bind!==!0){var itemsArr=eval(datasource)||[];for(var i=0;i<itemsArr.length;i++){var currItem=itemsArr[i],textStr=(text?currItem[text]:currItem)||"",iconStr=(text?currItem[icon]:"")||"",disabledStr=currItem[disabled]||"",currTemplate=conTemplateStr;conItemStr+=this.joinHtmlByAttrCss(currTemplate,{text:textStr,icon:iconStr,disabled:disabledStr},{},{})}}else conItemStr=this.joinHtmlToBindByAttrCss(conTemplateStr,{text:text,icon:icon,disabled:disabled},{click:""},{},!0),conItemStr=this.createForBind(conItemStr,datasource);return conItemStr},ptab_template.prototype.getTemplateStr=function(e,t){var n=this.joinLi(e,t),r=this[t+"Start"],i=this[t+"End"],s=r+n+i;return s};function ptab(){this.constructor=arguments.callee}ptab.prototype=new ptab_template,ptab.prototype.init=function(e,t,n){var r=this.getTemplateStr(t,e);this.renderView(r,this.controlTypes.ptab.name,e,t,n)},ptab.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e),o=s.find("["+this.contentTagMarker+"]").children();o.registerEventForColorChange(null,0);var u=s.find("["+this.contentTagMarker+"]");r.bind!==!0&&this.createEvent(u,this.controlTypes.ptab.name,"click",window[this.ptool.pstaticEventFnName]);if(n===this.controlTypes.ptab.types[1]){this.createEvent(u,this.controlTypes.ptab.name,"DOMSubtreeModified",window[this.ptool.pstaticEventFnName]);var a=s.find("["+this.leftMarker+"]"),f=s.find("["+this.rightMarker+"]");this.createEvent(a,this.controlTypes.ptab.name,"click",window[this.ptool.pstaticEventFnName]),this.createEvent(f,this.controlTypes.ptab.name,"click",window[this.ptool.pstaticEventFnName]),this.pisShowPage(s)}},ptab.prototype.eventHandout=function(e,t){function A(){var e=h,t=0;for(var r=0;r<e;r++){var i=n.getTextTypeLiWidth(l.eq(r));t+=i}return Math.min(t,d)}var n=this,r=$(t[this.ptool.eventCurrTargetName]),i=t.type;switch(i){case"click":var s=t.target,o=$(s),u=o.attr(this.leftMarker),a=o.attr(this.rightMarker);if(u||a){var f=r.find("["+this.contentTagMarker+"]"),l=f.children(),c=r[0][this.ptool.libraryToPro]||{},h=c[this.ptool.controlPrivateToProName]||0,p=f.parent().width()+this.clientPadding,d=f.width()-p,v=0,m=0;if(u){for(h;h>=0;h--){var g=this.getTextTypeLiWidth(l.eq(h));v+=g;if(v>=p)break}m=A(),f.animate({left:parseFloat("-"+m)},300),m==0?o.pdisable(!0):o.pdisable(!1),r.find("["+this.rightMarker+"]").pdisable(!1)}if(a){for(h;h<l.length;h++){var g=this.getTextTypeLiWidth(l.eq(h));v+=g;if(v>=p)break}m=A(),f.animate({left:parseFloat("-"+m)},300),m==d?o.pdisable(!0):o.pdisable(!1),r.find("["+this.leftMarker+"]").pdisable(!1)}c[this.ptool.controlPrivateToProName]=h,r[0][this.ptool.libraryToPro]=c;return}var y=o;y[0].tagName!="LI"&&(y=y.parent());var b=r.attr(this.ptool.libraryIdToHtml),w=ptab[b],E=w.event||{},S=this.ptool.getTypeAndChildTypeFromEle(r),x=this.selCss[S.childType],T=y.hasClass(x)?!0:!1,N=y.index();t=this.ptool.appendProToEvent(t,{state:T,index:N});var C=E.beforesel,k=!0;C&&(k=this.executeEventCall(e,t,C));if(k!==!1){this.cssChangeForSel(y,x),T=y.hasClass(x)?!0:!1,t=this.ptool.appendProToEvent(t,{state:T,index:N});var L=E.sel;L&&this.executeEventCall(e,t,L)}break;case"DOMSubtreeModified":this.pisShowPage(r)}},ptab.prototype.psel=function(e,t){var n=arguments[0],r=$(n),i=this.ptool.getTypeAndChildTypeFromEle(n),s=this.selCss[i.childType],o=r.find("["+this.contentTagMarker+"]").children();if(arguments.length===1)for(var u=0;u<o.length;u++)if(o.eq(u).hasClass(s))return u;e=arguments[1],t=arguments[2],t=t===!1?!1:!0;var a=o.eq(e),f=a.hasClass(s)?!0:!1;if(f)return e;if(t)return a[0].click();this.cssChangeForSel(a,s)},ptab.prototype.pisShowPage=function(e){var t=e.find("["+this.contentTagMarker+"]"),n=t.parent().width()+this.clientPadding,r=t.width();if(r>n){var i=e.find("["+this.leftMarker+"]"),s=e.find("["+this.rightMarker+"]");i.show(),s.show(),i.pdisable(!0)}},ptab.prototype.getTextTypeLiWidth=function(e){return e.width()+20+this.clientPadding},ptab.prototype.cssChangeForSel=function(e,t){e[0][pconst.targetHoverCssSourcePro]=[],e.css("backgroundColor",""),e.toggleClass(t),e.siblings().removeClass(t)};function pwindow_template(){this.constructor=arguments.callee,this.closeMarker="close",this.buttonsMarker="buttons",this.floatMarker="float",this.titleMarker="tit",this.subTitleMarker="subtit",this.global="<div "+this.ptool.maxDivMarker+' class="per-modal-control" style="display:none;opacity:0;" {{id}}><div class="per-modal-mask">'+'<div class="per-modal-global_x" '+this.closeMarker+'>x</div><div class="per-modal-global" {{templateid}}></div></div></div>',this.modal="<div "+this.ptool.maxDivMarker+' class="per-modal-control" style="display:none;opacity:0;" {{id}}><div class="per-modal-mask">'+'<div class="per-modal-custom"><div class="per-modal-custom_title" '+this.titleMarker+" {{text}}></div>"+'<div class="per-modal-custom_con" {{templateid}}></div></div></div></div>',this.confirm="<div "+this.ptool.maxDivMarker+' class="per-modal-control" style="display:none;opacity:0;" {{id}}><div class="per-modal-mask">'+'<div class="per-modal-common"><div class="per-modal-common_con">'+'<div class="per-modal-common_title" '+this.titleMarker+'{{text}}></div><div class="per-modal-common_subtitle" '+this.subTitleMarker+"{{subtitle}}></div>"+'</div><div class="per-modal-common_button" '+this.buttonsMarker+">",this.confirm2="</div></div></div></div>",this.float1="<div "+this.ptool.maxDivMarker+" "+this.floatMarker+' class="per-madal-float" style="',this.float2=">",this.float='<div class="per-madal-float_title"><div class="per-madal-float_x" '+this.closeMarker+">x</div>"+'<div class="per-madal-float_titcon"><b '+this.titleMarker+'{{text}}></b></div><div class="per-madal-float_operate"'+this.buttonsMarker+">",this.float3='</div></div><div class="per-madal-float_con"{{templateid}}></div></div>',this.floatShadeStart1="<div "+this.ptool.maxDivMarker+' class="per-modal-control" style="display:none;opacity:0;"',this.floatShadeStart2=">",this.floatShadeEnd="</div>",this.bubble="<div "+this.ptool.maxDivMarker+' class="per-modal-pop" style="display:none;"{{id}}>'+'<div class="per-modal-pop_title" '+this.titleMarker+"{{text}}></div>"+'<div class="per-modal-pop_subtitle" '+this.subTitleMarker+"{{subtitle}}></div>"+'<div class="per-modal-pop_button" '+this.buttonsMarker+">",this.bubble2="</div></div>"}pwindow_template.prototype=new persagyElement,pwindow_template.prototype.getTemplateStr=function(e,t){var n=e.attr;n.text=n.title;switch(t){case this.controlTypes.pwindow.types[3]:var r=n.animate||{},i=this.float+(n.buttons||"")+this.float3,s=this.float1+(r.orientation+":"+r.minpx+'px;"');return n.isshade?this.floatShadeStart1+"{{id}}"+this.floatShadeStart2+s+this.float2+i+this.floatShadeEnd:s+"{{id}}"+this.float2+i;case this.controlTypes.pwindow.types[2]:case this.controlTypes.pwindow.types[4]:return this[t]+(n.buttons||"")+this[t+"2"];default:return this[t]}};function pwindow(){this.constructor=arguments.callee}pwindow.prototype=new pwindow_template,pwindow.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css;r.buttons=n.find("button").html();var o=n.find("animate");r.animate={orientation:o.attr("orientation"),maxpx:o.attr("maxpx"),minpx:o.attr("minpx")},r.isshade=r.isshade===!1?!1:!0;var u=this.getTemplateStr(t,e);this.renderView(u,this.controlTypes.pwindow.name,e,t,n)},pwindow.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e),o=s.find("["+this.closeMarker+"]");o.length>0&&this.createEvent(o,this.controlTypes.pwindow.name,"click",window[this.ptool.pstaticEventFnName])},pwindow.prototype.eventHandout=function(e,t){var n=this,r=$(t[this.ptool.eventCurrTargetName]),i=t.type,s=$(t.currentTarget),o=this.ptool.getTypeAndChildTypeFromEle(r),u=r.attr(this.ptool.libraryIdToHtml),a=pwindow[u],f=a.event||{};if(i=="click"&&s.attr(this.closeMarker)==""){if(f.beforehide){var l=this.executeEventCall(e,t,f.beforehide);if(!l)return}switch(o.childType){case this.controlTypes.pwindow.types[0]:case this.controlTypes.pwindow.types[3]:r.phide(),this.executeEventCall(e,t,f.hide)}}},pwindow.prototype.pshow=function(e){var t=this,n=arguments[0];e=arguments[1]||{};var r=$(n),i=t.ptool.getTypeAndChildTypeFromEle(n),s=r.attr(t.ptool.libraryIdToHtml),o=pwindow[s],u=o.attr;i.childType!=t.controlTypes.pwindow.types[0]&&e.title&&r.find("["+this.titleMarker+"]").text(e.title),(i.childType==t.controlTypes.pwindow.types[2]||i.childType==t.controlTypes.pwindow.types[4])&&e.subtitle&&r.find("["+this.subTitleMarker+"]").text(e.subtitle);switch(i.childType){case t.controlTypes.pwindow.types[0]:case t.controlTypes.pwindow.types[1]:case t.controlTypes.pwindow.types[2]:r.show(),r.animate({opacity:1},500);break;case t.controlTypes.pwindow.types[3]:var a=u.animate||{};e={},e[a.orientation]=a.maxpx+"px",u.isshade===!1?r.css(e):(r.show(),r.animate({opacity:1},200,function(){r.find("["+t.floatMarker+"]").css(e)}));break;case t.controlTypes.pwindow.types[4]:r.css(e),r.show()}},pwindow.prototype.phide=function(e){var t=this,n=arguments[0];e=arguments[1]||{};var r=$(n),i=t.ptool.getTypeAndChildTypeFromEle(n),s=r.attr(t.ptool.libraryIdToHtml),o=pwindow[s],u=o.attr;switch(i.childType){case t.controlTypes.pwindow.types[0]:case t.controlTypes.pwindow.types[1]:case t.controlTypes.pwindow.types[2]:r.animate({opacity:0},500,function(){r.hide()});break;case t.controlTypes.pwindow.types[3]:var a=u.animate||{};e={},e[a.orientation]=a.minpx+"px",u.isshade===!1?r.css(e):(r.find("["+t.floatMarker+"]").css(e),r.animate({opacity:0},500,function(){r.hide()}));break;case t.controlTypes.pwindow.types[4]:r.hide()}};function ppage_template(){this.constructor=arguments.callee,this.leftButtonMarker="ltp",this.rightButtonMarker="rtp",this.pageComboboxMarker="pagebox",this.fullUlMarker="fullul",this.fullTextMarker="fulltext",this.dotCss="per-paging-dot",this.fullSelCss="per-paging-pitch",this.dotStr="···",this.start="<div {{id}} "+this.ptool.maxDivMarker+' class="per-paging-normal"><div class="per-paging-concise">',this.end="</div></div>",this.leftButton='<pbutton-white icon="l" '+this.leftButtonMarker+' click="ppage.prevPageFn"></pbutton-white>',this.rightButton='<pbutton-white icon="r" '+this.rightButtonMarker+' click="ppage.nextPageFn"></pbutton-white>',this.fullPageNumberUlStart='<ul class="per-paging-page" '+this.fullUlMarker+">",this.fullPageNumberUlEnd="</ul>",this.fullPageInputDiv='<div class="per-paging-number">跳转到<ptext-text '+this.fullTextMarker+'><verify verifytype="positiveint" errtip="页码必须为正整数"></verify>'+'</ptext-text>页</div><pbutton-white text="确定" click="ppage.sureClick"></pbutton-white>'}ppage_template.prototype=new persagyElement,ppage_template.prototype.getTemplateStr=function(e,t){var n=e.attr,r=e.event;switch(t){case this.controlTypes.ppage.types[0]:var i="<pcombobox-page "+this.pageComboboxMarker+' orientation="'+(n.orientation||"")+'" number="'+(n.number||"")+'" sel="ppage.selPageFn"></pcombobox-page>';return this.start+this.leftButton+i+this.rightButton+this.end;default:var s=this.createFullPageCon(n.number,1);return this.start+this.leftButton+s+this.rightButton+this.fullPageInputDiv+this.end}},ppage_template.prototype.createFullPageCon=function(e,t){var n=this.createLiStr(e,t);return this.fullPageNumberUlStart+n+this.fullPageNumberUlEnd},ppage_template.prototype.createLiStr=function(e,t){function f(e,r){return'<li class="per-paging-item '+(r===!0?n.dotCss:"")+" "+(e===t?n.fullSelCss:"")+'">'+e+"</li>"}var n=this,r=f(t),i=t,s=t;for(var o=1;o<=2;o++){var u=t-o;if(u<=0)break;i=u;var a=f(u);r=a+r}i-1>1&&(r=f(n.dotStr,!0)+r),i-1>0&&(r=f(1)+r);for(o=1;o<=2;o++){u=t+o;if(u>e)break;s=u;var a=f(u);r+=a}return e-s>1&&(r+=f(n.dotStr,!0)),e-s>0&&(r+=f(e)),r};function ppage(){this.constructor=arguments.callee}ppage.prototype=new ppage_template,ppage.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css;r.number=r.number||1;var o=this.getTemplateStr(t,e);this.renderView(o,this.controlTypes.ppage.name,e,t,n)},ppage.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e);s.find("["+this.leftButtonMarker+"]").pdisable(!0),r.number==1&&(s.find("["+this.rightButtonMarker+"]").pdisable(!0),s.find("["+this.pageComboboxMarker+"]").pdisable(!0)),this.createEvent(s.find("["+this.fullUlMarker+"]"),this.controlTypes.ppage.name,"click",window[this.ptool.pstaticEventFnName])},ppage.prototype.eventHandout=function(e,t){var n=$(t.currentTarget).parents("["+this.ptool.maxDivMarker+"]").eq(0),r=$(t.target),i=r.text(),s=parseInt(i);if(i==this.dotStr)if(r.index()==1){var o=r.next().text();s=parseInt(o)-1}else{var u=r.prev().text();s=parseInt(u)+1}this.pageChangedToData(n,s,t)},ppage.prototype.pageChangedToData=function(e,t,n){n[this.ptool.eventCurrTargetName]=e[0];var r=e.attr(this.ptool.libraryIdToHtml),i=ppage[r];this.pageChanged(e,t);var s=n[this.ptool.eventOthAttribute]||{};s.pageIndex=t,n[this.ptool.eventOthAttribute]=s,this.executeEventCall(null,n,i.event.sel)},ppage.prototype.pageBefore=function(e){var t=$(e.currentTarget).parents("["+this.ptool.maxDivMarker+"]").eq(0),n=t[0],r=n[this.ptool.libraryToPro]||{},i=r[this.ptool.controlPrivateToProName]||1,s=t.attr(this.ptool.libraryIdToHtml),o=ppage[s],u=o.attr,a=u.number,f=t.find("["+this.leftButtonMarker+"]"),l=t.find("["+this.rightButtonMarker+"]");return a==1?(f.pdisable(!0),l.pdisable(!0),!1):{currPageIndex:i,leftTarget:f,_oldPpro:r,ele:n,rightTarget:l,pageCount:a}},ppage.prototype.pageChanged=function(e,t){var n=e[0],r=n[this.ptool.libraryToPro]||{};r[this.ptool.controlPrivateToProName]=t,n[this.ptool.libraryToPro]=r;var i=e.attr(this.ptool.libraryIdToHtml),s=ppage[i],o=s.attr,u=o.number,a=this.ptool.getTypeAndChildTypeFromEle(e),f=e.find("["+this.leftButtonMarker+"]"),l=e.find("["+this.rightButtonMarker+"]"),c=e.find("["+this.pageComboboxMarker+"]");u==1?(f.pdisable(!0),l.pdisable(!0),c.pdisable(!0)):(c.pdisable(!1),t==1?(f.pdisable(!0),l.pdisable(!1)):t==u?(l.pdisable(!0),f.pdisable(!1)):(l.pdisable(!1),f.pdisable(!1)));if(a.childType===this.controlTypes.ppage.types[1]){var h=this.createLiStr(o.number,t),p=e.find("["+this.fullUlMarker+"]");p.empty(),p.append(h)}},ppage.prototype.psel=function(e,t){var n=arguments[0],r=$(n),i=this.ptool.getTypeAndChildTypeFromEle(r);if(arguments.length==1){var s=n[this.ptool.libraryToPro]||{};return s[this.ptool.controlPrivateToProName]||1}e=parseInt(arguments[1]);if(!e)return!1;t=arguments[2],t=t===!1?!1:!0,t||this.pageChanged(r,e);if(i.childType===this.controlTypes.ppage.types[0])return r.find("["+this.pageComboboxMarker+"]").psel(e-1,t);t&&this.pageChangedToData(r,e,{})},ppage.prototype.pcount=function(e){var t=arguments[0],n=$(t),r=this.ptool.getTypeAndChildTypeFromEle(n),i=n.attr(this.ptool.libraryIdToHtml),s=ppage[i],o=s.attr,u=o.number;if(arguments.length==1)return u;e=arguments[1],e=parseInt(e),o.number=e,s.attr=o,ppage[i]=s;var a=t[this.ptool.libraryToPro]||{},f=a[this.ptool.controlPrivateToProName]||1;e<f&&(f=1),a[this.ptool.controlPrivateToProName]=f,t[this.ptool.libraryToPro]=a,this.pageChanged(n,f);if(r.childType===this.controlTypes.ppage.types[0]){var l=n.find("["+this.pageComboboxMarker+"]");l.pcount(e),l.psel(f-1,!1)}else{var c=n.find("["+this.fullUlMarker+"]"),h=this.createLiStr(e,f);c.empty(),c.append(h)}},ppage.prevPageFn=function(e){var t=new ppage,n=t.pageBefore(e);if(n==0)return;n.rightTarget.pdisable(!1);var r=n.currPageIndex,i=n._oldPpro,s=n.ele;if(r==1)return n.leftTarget.pdisable(!0);--r,s.psel(r)},ppage.nextPageFn=function(e){var t=new ppage,n=t.pageBefore(e);if(n==0)return;n.leftTarget.pdisable(!1);var r=n.currPageIndex,i=n._oldPpro,s=n.ele;if(r==n.pageCount)return n.rightTarget.pdisable(!0);++r,s.psel(r)},ppage.selPageFn=function(e){var t=new ppage,n=$(e[t.ptool.eventCurrTargetName]).parents("["+t.ptool.maxDivMarker+"]").eq(0),r=e[t.ptool.eventOthAttribute],i=r.index+1;t.pageChangedToData(n,i,e)},ppage.sureClick=function(e){var t=new ppage,n=$(e.currentTarget).parents("["+t.ptool.maxDivMarker+"]").eq(0),r=n.find("["+t.fullTextMarker+"]"),i=r.pval();if(!i)return;if(!r.pverifi())return;var s=parseInt(i);t.pageChangedToData(n,s,e)};function psearch_template(){this.constructor=arguments.callee,this.friendlyUlMarker="friul",this.inputMarker="schinput",this.friendlyMarker="fri",this.scrollMarker="scro",this.liTextMarker="litt",this.comboboxMarker="scom",this.clearMarker="clear",this.delaySearchMarker="dsm",this.friendlyMaxHeight=(new pcombobox_template).comboxMaxHeight,this.inputSelCss="per-searchbox-delay_border",this.maxDelayCss="per-searchbox-delay",this.maxPromptlyCss="per-searchbox-promptly",this.start="<div {{id}} "+this.ptool.maxDivMarker+' class="',this.start2='">',this.comboxStart='<div class="per-searchbox-combobox" '+this.comboboxMarker+">",this.comboxEnd="</div>",this.searchInputStart='<div class="per-searchbox-input">',this.promptlySearchIcon='<div class="per-searchbox-icon">f</div>',this.searchInputMiddle='<input {{placeholder}} type="text" '+this.inputMarker+'/><div class="per-searchbox-input_x" '+this.clearMarker+">x</div>",this.searchFriendlyStart='<div class="per-combobox-wrap" style="display: none;" '+this.friendlyMarker+'><div class="per-combobox-con" style="display:inline-block;"><pscroll-small '+this.scrollMarker+' templateid="',this.searchFriendlyStart2='"></pscroll-small>',this.searchFriendlyend="</div></div>",this.friendlyUlCon="<ul "+this.friendlyUlMarker+" "+this.ptool.libraryTypeToHtml+'="',this.friendlyUlCon2='"></ul>',this.searchInputEnd="</div>",this.delaySearchIcon='<div class="per-searchbox-icon" '+this.delaySearchMarker+">f</div>",this.end="</div>"}psearch_template.prototype=new persagyElement,psearch_template.prototype.getTemplateStr=function(e,t){var n=e.attr,r=n.tip,i="";if(n.comboboxHtml){var s="<div>"+this.comboxStart+n.comboboxHtml+this.comboxEnd+"</div>",o=$(s),u=o.children().children().eq(0);u.attr("sel","psearch.typeSel"),u.attr("isborder","false"),i=o.html()}var a="";if(r.suggestsource||r.advisesource){var f=this.controlTypes.psearch.name+this.ptool.typeSeparator+t,l=this.ptool.createDynamicTemplate(this.friendlyUlCon+f+this.friendlyUlCon2);a=this.searchFriendlyStart+l+this.searchFriendlyStart2+this.searchFriendlyend}return this.start+(t==this.controlTypes.psearch.types[0]?this.maxDelayCss:this.maxPromptlyCss)+this.start2+i+this.searchInputStart+(t==this.controlTypes.psearch.types[1]?this.promptlySearchIcon:"")+this.searchInputMiddle+a+this.searchInputEnd+(t==this.controlTypes.psearch.types[0]?this.delaySearchIcon:"")+this.end},psearch_template.prototype.createAdviseLiStr=function(objBind,val){var attr=objBind.attr,tipObj=attr.tip,source,type,textPro;val?(source=tipObj.suggestsource,type=1,textPro=tipObj.suggesttext):(source=tipObj.advisesource,type=2,textPro=tipObj.advisetext);if(!source)return;var liStr="",sourceArr=eval(source);for(var i=0;i<sourceArr.length;i++){var currItem=sourceArr[i],textVal=textPro?currItem[textPro]:currItem,bStr="";if(type==1){var splitObj=this.ptool.splitStrByKey(val,textVal);splitObj&&(bStr=splitObj.start+'<em class="per-searchbox-select_color">'+splitObj.key+"</em>"+splitObj.end)}else bStr=textVal;if(!bStr)continue;liStr+='<li class="per-combobox_item" '+this.liTextMarker+'="'+textVal+'"><b>'+bStr+"</b></li>"}return liStr};function psearch(){this.constructor=arguments.callee}psearch.prototype=new psearch_template,psearch.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css,o=n.find("tip");r.tip={suggestsource:o.attr("suggestsource"),suggesttext:o.attr("suggesttext"),advisesource:o.attr("advisesource"),advisetext:o.attr("advisetext")},!r.tip.suggestsource&&!r.tip.advisesource?r.friendly=!1:r.friendly=!0,r.comboboxHtml=n.find("combobox").html();var u=this.getTemplateStr(t,e);this.renderView(u,this.controlTypes.psearch.name,e,t,n)},psearch.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e),o=s.find("["+this.inputMarker+"]");this.createEvent(o,this.controlTypes.psearch.name,"focus",window[this.ptool.pstaticEventFnName]),this.createEvent(o,this.controlTypes.psearch.name,"blur",window[this.ptool.pstaticEventFnName]),this.createEvent(o,this.controlTypes.psearch.name,"input",window[this.ptool.pstaticEventFnName]),this.createEvent(o,this.controlTypes.psearch.name,"click",window[this.ptool.pstaticEventFnName]);var u=s.attr(this.ptool.libraryIdToHtml),a=s.find("["+this.friendlyUlMarker+"]");a.attr(this.ptool.libraryIdToHtml,u),this.createEvent(a,this.controlTypes.psearch.name,"click",window[this.ptool.pstaticEventFnName]),this.createEvent(s.find("["+this.clearMarker+"]"),this.controlTypes.psearch.name,"click",window[this.ptool.pstaticEventFnName]),this.createEvent(s.find("["+this.delaySearchMarker+"]"),this.controlTypes.psearch.name,"click",window[this.ptool.pstaticEventFnName])},psearch.prototype.eventHandout=function(e,t){function m(){if(l.friendly===!0){var e=n.createAdviseLiStr(a,h.val());if(e){r.find("["+n.scrollMarker+"]").css({"max-width":c.width(),"max-height":n.friendlyMaxHeight});var t=r.find("["+n.friendlyUlMarker+"]");t.empty(),t.append(e),c.show()}else c.hide()}}function g(){var r={key:h.val(),type:s.psel()};t[n.ptool.eventOthAttribute]=r,n.executeEventCall(e,t,f.change)}function y(){var e=r.find("["+n.clearMarker+"]");h.val().length>0?e.show():e.hide()}var n=this,r=$(t[n.ptool.eventCurrTargetName]),i=r.attr(n.ptool.libraryIdToHtml);r[0].tagName=="UL"&&(r=r.parents("["+n.ptool.libraryIdToHtml+'="'+i+'"]').eq(0));var s=r.find("["+n.comboboxMarker+"]"),o=t.type,u=n.ptool.getTypeAndChildTypeFromEle(r),a=psearch[i],f=a.event||{},l=a.attr,c=r.find("["+n.friendlyMarker+"]"),h=r.find("["+n.inputMarker+"]");switch(o){case"focus":r.addClass(n.inputSelCss),m(),y();break;case"blur":r.removeClass(n.inputSelCss);break;case"input":var p=h.val();m(),u.childType===this.controlTypes.psearch.types[1]&&g(),y();break;case"click":if(t.currentTarget.tagName=="UL"){var d=$(t.target);t.target.tagName!="LI"&&(d=d.parent());var v=d.attr(n.liTextMarker);h.val(v),g(),c.hide(),y()}$(t.currentTarget).attr(n.clearMarker)==""&&(h.val(""),y(),s.precover(),g()),$(t.currentTarget).attr(n.delaySearchMarker)==""&&g()}},psearch.prototype.pval=function(e){var t=arguments[0],n=$(t),r=n.find("["+this.inputMarker+"]"),i=n.find("["+this.comboboxMarker+"]");if(arguments.length==1){var s=r.val(),o=i.psel();return{key:s,type:o}}e=arguments[1]||{};var u=e.value,a=e.indexOrText,f=e.isEvent||!1;i.psel(a,!1),r.val(u||"");if(f){var l=n.attr(this.ptool.libraryIdToHtml),c=psearch[l],h=c.event||{},p={key:r.val(),type:i.psel()},d=this.ptool.appendProToEvent({},p);this.executeEventCall(null,d,h.change)}},psearch.prototype.precover=function(e,t){var n=arguments[0],r=$(n);r.find("["+this.comboboxMarker+"]").precover(arguments[1]),t=arguments[2]===!1?!1:!0;var i=r.find("["+this.clearMarker+"]");if(t)return i[0].click();i.hide(),r.find("["+this.inputMarker+"]").val("")},psearch.typeSel=function(e,t){};function pupload_template(){this.constructor=arguments.callee,this.inputFileMarker="itfile",this.imgUploadingSrc="./imgs/uploadingImg.png",this.imgMarkr="timg",this.fileRegionUlMarker="fileul",this.fileLabelMarker="filelabel",this.clearMarker="clear",this.currNumberMarker="crnu",this.uploadBarMarker="uploadbar",this.fileNameMarker="fname",this.oneFileLiMarker="fileli",this.fileDisableMarker="fdis",this.img1="<div "+this.ptool.maxDivMarker+'{{id}} class="per-upload-picture ',this.img4='"><ul '+this.fileRegionUlMarker+' class="per-upload-picture-ul"></ul><div class="per-upload-picture-wrap"><label '+this.fileLabelMarker,this.img2=' class="per-upload-picture_label"><span>J</span><span>点击上传</span></label><input '+this.inputFileMarker+' accept="image/jpeg,image/gif,image/jpg,image/png" type="file" id="',this.img3='" style="display: none;"></div></div>',this.imgHorizontalCss="per-upload_horizontal",this.imgVerticalCss="per-upload_vertical",this.lonelyFile1="<div "+this.ptool.maxDivMarker+'{{id}} class="per-upload-onlyfile"><pbutton-white click="pupload.uploadBtnClick" text="点击上传" icon="d" '+this.fileLabelMarker+"></pbutton-white><input "+this.inputFileMarker+' {{accept}} type="file" id="',this.lonelyFile3='" style="display: none;"><div class="per-upload-onlyfile_file" '+this.oneFileLiMarker+'><div class="per-upload-onlyfile_name" '+this.fileDisableMarker+"><b "+this.fileNameMarker+'></b></div><span class="per-upload-manyfile_x" '+this.clearMarker+">x</span>"+'<div class="per-upload-manyfile_bar" '+this.uploadBarMarker+"></div></div></div>",this.multipleFile1="<div "+this.ptool.maxDivMarker+'{{id}} class="per-upload-manyfile"><pbutton-white click="pupload.uploadBtnClick" text="点击上传" icon="d" '+this.fileLabelMarker+'></pbutton-white><div class="per-upload-count"><em '+this.currNumberMarker+">0</em>/<em>",this.multipleFile2="</em></div><input "+this.inputFileMarker+' {{accept}} type="file" id="',this.multipleFile3='" style="display: none;"><ul '+this.fileRegionUlMarker+"></ul></div>"}pupload_template.prototype=new persagyElement,pupload_template.prototype.getTemplateStr=function(e,t){var n=e.attr,r=ptool.produceId();switch(t){case this.controlTypes.pupload.types[1]:return this.img1+(n.arrange==this.ptool.arrangeType.horizontal?this.imgHorizontalCss:this.imgVerticalCss)+this.img4+this.img2+r+this.img3;default:return n.number==1?this.lonelyFile1+r+this.lonelyFile3:this.multipleFile1+n.number+this.multipleFile2+r+this.multipleFile3}},pupload_template.prototype.createImgRegion=function(e,t){return e==this.controlTypes.pupload.types[1]?'<li class="per-upload-picture-wrap" '+this.oneFileLiMarker+'><div class="per-upload-picture_x" '+this.clearMarker+">x</div><img "+this.imgMarkr+' src="'+this.imgUploadingSrc+'"></li>':'<li class="per-upload-manyfile_item" '+this.oneFileLiMarker+'><div class="per-upload-onlyfile_name"'+this.fileDisableMarker+"><b "+this.fileNameMarker+">"+t+'</b></div><span class="per-upload-manyfile_x"'+this.clearMarker+'>x</span><div class="per-upload-manyfile_bar" '+this.uploadBarMarker+"></div></li>"};function pupload(){this.constructor=arguments.callee}pupload.prototype=new pupload_template,pupload.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css;r.number=r.number||1,r.arrange=r.arrange||this.ptool.arrangeType.horizontal;var o=n.find("panel");r.panel={change:o.attr("change"),success:o.attr("success"),err:o.attr("err"),progress:o.attr("progress"),clear:o.attr("clear")};var u=this.getTemplateStr(t,e);this.renderView(u,this.controlTypes.pupload.name,e,t,n)},pupload.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e),o=s.find("["+this.inputFileMarker+"]");this.createEvent(o,this.controlTypes.pupload.name,"change",window[this.ptool.pstaticEventFnName]),n==this.controlTypes.pupload.types[0]?r.number==1&&(this.createEvent(s.find("["+this.clearMarker+"]"),this.controlTypes.pupload.name,"click",window[this.ptool.pstaticEventFnName]),this.createEvent(s.find("["+this.oneFileLiMarker+"]"),this.controlTypes.pupload.name,"click",window[this.ptool.pstaticEventFnName])):this.createEvent(s.find("["+this.fileLabelMarker+"]"),this.controlTypes.pupload.name,"click",window[this.ptool.pstaticEventFnName])},pupload.prototype.eventHandout=function(e,t){var n=this,r=$(t[this.ptool.eventCurrTargetName]),i=r[0],s=t.type,o=$(t.currentTarget),u=r.find("["+this.inputFileMarker+"]"),a=r.find("["+this.fileLabelMarker+"]"),f=r.find("["+this.currNumberMarker+"]"),l=r.find("["+this.oneFileLiMarker+"]"),c=r.find("["+this.fileRegionUlMarker+"]"),h=this.ptool.getTypeAndChildTypeFromEle(r),p=r.attr(this.ptool.libraryIdToHtml),d=pupload[p],v=d.event||{},m=d.attr,g=m.panel,y=n.createXmlhttpName(p),b=parseInt(f.text())||0;switch(s){case"click":if(o.attr(this.fileLabelMarker)!=null)d.fileLabelIndex=-1,u[0].click();else if(o.attr(this.clearMarker)!=null){d[y]&&d[y].abort();if(h.childType==this.controlTypes.pupload.types[0]&&m.number==1)d.files=[],l.hide(),a.show();else{var w=o.parent(),E=w.index();w.remove(),d.files.splice(E,1),h.childType==this.controlTypes.pupload.types[1]?a.parent().show():(--b,f.text(b),a.pdisable(!1))}this.executeEventCall(e,t,g.clear)}else o.attr(this.oneFileLiMarker)!=null&&(d.fileLabelIndex=o.index(),u[0].click());break;case"change":var S=u[0].files[0],x;if(h.childType==this.controlTypes.pupload.types[0]&&m.number==1)a.hide(),l.find("["+this.uploadBarMarker+"]").show(),l.find("["+this.fileNameMarker+"]").text(S.name),l.show(),x=l;else if(d.fileLabelIndex==-1){var T=this.createImgRegion(h.childType,S.name);c.append(T),this.createEvent(r.find("["+this.clearMarker+"]:last"),this.controlTypes.pupload.name,"click",window[this.ptool.pstaticEventFnName]),this.createEvent(c.find("["+this.oneFileLiMarker+"]:last"),this.controlTypes.pupload.name,"click",window[this.ptool.pstaticEventFnName]),x=c.find("li:last")}else{var N=c.children().eq(d.fileLabelIndex);N.find("["+this.clearMarker+"]").show();switch(h.childType){case this.controlTypes.pupload.types[0]:N.find("["+this.uploadBarMarker+"]").show(),N.find("["+this.fileNameMarker+"]").text(S.name);break;case this.controlTypes.pupload.types[1]:N.find("["+this.imgMarkr+"]").attr("src",this.imgUploadingSrc)}x=N}var C=pajax.upload({file:S,success:this.psuccess(r,d,x,g.success),progress:this.pprogress(x,g.progress),error:this.perror(r,d,x,g.err)});d[y]=C,x.find("["+this.fileDisableMarker+"]").pdisable(!0),u[0].value="",t=this.ptool.appendProToEvent(t,{file:S}),this.executeEventCall(e,t,g.change)}pupload[p]=d},pupload.prototype.pprogress=function(e,t){return function(e,t){return function(n){var r=new pupload;e.find("["+r.uploadBarMarker+"]").css({width:n.probe+"%"}),r.executeEventCall(null,n,t)}}(e,t)},pupload.prototype.psuccess=function(e,t,n,r){return function(t,n,r,i){return function(s){s=s||{};var o=new pupload;if(s.result!==1){o.perror(e,n,r)({status:500,responseText:"程序异常",statusText:"程序异常"});return}var u=t.find("["+o.currNumberMarker+"]"),a=t.attr(o.ptool.libraryIdToHtml),f=parseInt(u.text())||0,l=pupload[a],c=o.createXmlhttpName(a),h=o.ptool.getTypeAndChildTypeFromEle(t),c=o.createXmlhttpName(a);n[c]=null;var p=s.showUrl+"?ft="+(h.childType===o.controlTypes.pupload.types[1]?"1":"2"),d={url:p,name:s.name,suffix:s.suffix,isNewFile:!0},v=n.files||[];n.fileLabelIndex===-1?(v.push(d),++f):v.splice(n.fileLabelIndex,1,d),n.files=v,pupload[a]=n,u.text(f);var m=n.attr;if(h.childType==o.controlTypes.pupload.types[1]||h.childType==o.controlTypes.pupload.types[0]&&m.number>1)if(r.siblings().length+1==m.number){var g=t.find("["+o.fileLabelMarker+"]");h.childType==o.controlTypes.pupload.types[1]?g.parent().hide():g.pdisable(!0)}r.find("["+o.fileDisableMarker+"]").pdisable(!1),r.find("["+o.uploadBarMarker+"]").hide();switch(h.childType){case o.controlTypes.pupload.types[1]:r.find("["+o.imgMarkr+"]").attr("src",p)}o.executeEventCall(null,null,i)}}(e,t,n,r)},pupload.prototype.perror=function(e,t,n,r){return function(e,t,n,r){return function(e){alert("err");var t=new pupload;t.executeEventCall(null,null,r)}}(e,t,n,r)},pupload.prototype.createXmlhttpName=function(e){return e+"XHTTP"},pupload.prototype.pval=function(e){var t=this,n=arguments[0],r=$(n),i=r.attr(this.ptool.libraryIdToHtml),s=pupload[i],o=s.attr;if(arguments.length==1)return JSON.parse(JSON.stringify(s.files||[]));var u=[];e=arguments[1]||[];var a=r.find("["+this.currNumberMarker+"]");a.text(e.length);var f=this.ptool.getTypeAndChildTypeFromEle(n),l=r.find("["+this.fileRegionUlMarker+"]"),c=r.find("["+this.fileLabelMarker+"]"),h=r.find("["+this.oneFileLiMarker+"]");for(var p=0;p<e.length;p++){var d=e[p],v=d.url+(d.url.indexOf("ft=")==-1?"?ft="+(f.childType===this.controlTypes.pupload.types[1]?"1":"2"):""),m=d.name||"",g=d.suffix||"",y=m.indexOf(".");y>-1?(g=m.substring(y+1),m=m.substring(0,y)):"",u.push({url:v,name:m,suffix:g,isNewFile:!1});if(f.childType===this.controlTypes.pupload.types[0]&&o.number===1){c.hide(),h.find("["+this.fileNameMarker+"]").text(m),h.show();break}var b=this.createImgRegion(f.childType,m);l.append(b),f.childType===this.controlTypes.pupload.types[1]&&l.children().filter(":last").find("["+this.imgMarkr+"]").attr("src",v),this.createEvent(r.find("["+this.clearMarker+"]:last"),this.controlTypes.pupload.name,"click",window[this.ptool.pstaticEventFnName])}r.find("["+this.uploadBarMarker+"]").hide(),s.files=u,pupload[i]=s;switch(f.childType){case this.controlTypes.pupload.types[0]:o.number>1&&(e.length===o.number?c.pdisable(!0):c.pdisable(!1));break;case this.controlTypes.pupload.types[1]:e.length===o.number?c.parent().hide():c.parent().show()}},pupload.prototype.precover=function(){var e=arguments[0],t=$(e),n=t.attr(this.ptool.libraryIdToHtml),r=pupload[n],i=r.attr,s=this.ptool.getTypeAndChildTypeFromEle(e),o=t.find("["+this.fileLabelMarker+"]");switch(s.childType){case this.controlTypes.pupload.types[0]:if(i.number===1){var u=t.find("["+this.oneFileLiMarker+"]");u.find("["+this.fileNameMarker+"]").text(""),u.hide(),o.show();break};case this.controlTypes.pupload.types[1]:t.find("["+this.fileRegionUlMarker+"]").empty(),o.pdisable(!1),o.parent().show()}r.files=[],t.find("["+this.currNumberMarker+"]").text(0)},pupload.uploadBtnClick=function(e){var t=new pupload,n=$(e.currentTarget).parent(),r=n[0],i=n.find("["+t.inputFileMarker+"]"),s=t.ptool.getTypeAndChildTypeFromEle(n),o=n.attr(t.ptool.libraryIdToHtml),u=pupload[o];u.fileLabelIndex=-1,i[0].click()};function ptree_template(){this.constructor=arguments.callee,this.foldIconObj={b:"r",r:"b"},this.foldMarker="fold",this.treeRegionMarker="treeregion",this.bodyRegionMarker="bodymarker",this.itemTitleMarker="itemtext",this.itemTitleValMarker="itemtextval",this.resultUlMarker="rul",this.resultMarker="sresult",this.operMarker="operd",this.operUlMarker="operdul",this.treeSearchMarker="tsm",this.singleCss="per-structure-single",this.panelCss="per-structure-default",this.selCss="per-tree-ts_active",this.start="<div "+this.ptool.maxDivMarker+' class="per-structure-normal ',this.start2='"{{id}}>',this.searchStr='<div class="per-structure-title"><psearch-promptly '+this.treeSearchMarker+' change="ptree.searchPromptly"></psearch-promptly></div>',this.conout1='<div class="per-structure-con" '+this.bodyRegionMarker+'><pscroll-small templateid="',this.conout2='"></pscroll-small></div></div>',this.conSearchResultRegion="<div "+this.resultMarker+' class="per-tree-soso_result"><ul '+this.resultUlMarker+"></ul></div>",this.conOperStr='<div class="per-tree-ts"><span '+this.operMarker,this.conOperStr2=">n</span><ul "+this.operUlMarker+' style="display: none;"',this.conOperStr3="><li>选择所有子级</li><li>选择下一级</li><li>取消选择所有子级</li></ul></div>"}ptree_template.prototype=new persagyElement,ptree_template.prototype.getTemplateStr=function(e,t){var n=e.attr,r=n.panel,i=n.item,s=this.start+(r?this.panelCss:"")+this.start2+(n.issearch===!0?this.searchStr:""),o=this.conSearchResultRegion,u=ptool.produceId(),a="",f=ptool.produceId(),l=persagy_toBind.getInstance(),c="";switch(l.currFrameType){case l.frameTypes.ko:c=this.conOperStr+' data-bind="click:'+this.ptool.pbindEventFnName+'"'+this.conOperStr2+' data-bind="click:'+this.ptool.pbindEventFnName+'"'+this.conOperStr3,o+="<div "+this.treeRegionMarker+' class="per-tree-wrap" data-bind="template:{name:'+f+",foreach:"+n.datasource+'}"></div>';var h=",attr:{"+this.itemTitleMarker+":"+(i.itemid||"''")+"}";a='<div class="per-tree-temp"><div data-bind="click:'+this.ptool.pbindEventFnName+",style:{'padding-left':(level*15+20)+'px'}"+h+'" class="per-tree-title'+(n.number===1?" per-structure-single":"")+'"><div class="per-slh"><span '+this.foldMarker+' class="per-tree-arrow" data-bind="click:'+this.ptool.pbindEventFnName+",style:{visibility:"+i.child+"&&"+i.child+".length>0?'visible':'hidden'}\">"+this.foldIconObj.b+"</span><b "+this.itemTitleValMarker+' data-bind="text:'+i.text+'"></b></div>'+(n.number===1?"":c)+'</div><div class="per-tree-con" style="display:none;" '+'data-bind="template:{name:'+f+",foreach:"+i.child+'}"></div></div>';break;case l.frameTypes.Vue:c=this.conOperStr+' @click="'+this.ptool.pbindEventFnName+'(model,$event)"'+this.conOperStr2+' @click="'+this.ptool.pbindEventFnName+'(model,$event)"'+this.conOperStr3;var p="vuetag"+f;o+='<div class="per-tree-wrap" '+this.treeRegionMarker+"><"+p+' v-for="item in '+n.datasource+'" :model="item"></'+p+"></div>";var h=" v-bind:"+this.itemTitleMarker+'="'+(i.itemid?"model."+i.itemid:"''")+'"';a='<div class="per-tree-temp"><div '+h+'  @click="'+this.ptool.pbindEventFnName+"(model,$event)\" v-bind:style=\"{'padding-left':(model.level*15+20)+'px'}\" class=\"per-tree-title"+(n.number===1?" per-structure-single":"")+'"><div class="per-slh"><span '+this.foldMarker+' class="per-tree-arrow" @click="'+this.ptool.pbindEventFnName+'(model,$event)" v-bind:style="{visibility:model.'+i.child+"&&model."+i.child+".length>0?'visible':'hidden'}\">"+this.foldIconObj.b+"</span><b "+this.itemTitleValMarker+' v-text="model.'+i.text+'"></b></div>'+(n.number===1?"":c)+'</div><div class="per-tree-con" style="display:none;" '+"><"+p+' v-for="item in model.'+i.child+'" :model="item"></'+p+"></div></div>"}this.ptool.createDynamicTemplate(o,u),this.ptool.createDynamicTemplate(a,f),l.currFrameType==l.frameTypes.Vue&&Vue.component(p,{template:"#"+f,props:{model:Object},methods:{}});var d=this.conout1+u+this.conout2;return s+d};function ptree(){this.constructor=arguments.callee}ptree.prototype=new ptree_template,ptree.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css;r.bind=!0,r.number=r.number>1?r.number:1;var o=n.find("panel");o.length>0&&(r.panel={width:o.attr("width"),height:o.attr("height")});var u=n.find("item");r.item={itemid:u.attr("itemid"),text:u.attr("text"),disabled:u.attr("disabled"),child:u.attr("child"),issearch:u.attr("issearch")},r.issearch=r.item.issearch==="false"?!1:!0;var a=this.getTemplateStr(t,e);this.renderView(a,this.controlTypes.ptree.name,e,t,n)},ptree.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e),o=s.attr(this.ptool.libraryIdToHtml),u=this.controlTypes.ptree.name+this.ptool.typeSeparator+n,a=s.find("["+this.treeRegionMarker+"]");a.attr(this.ptool.libraryTypeToHtml,u),a.attr(this.ptool.libraryIdToHtml,o);var f=s.find("["+this.resultMarker+"]");f.attr(this.ptool.libraryTypeToHtml,u),f.attr(this.ptool.libraryIdToHtml,o);var l=s.find("["+this.bodyRegionMarker+"]"),c=l.width(),h=l.height(),p=this.controlTypes.pscroll.name+this.ptool.typeSeparator+this.controlTypes.pscroll.types[0];s.find(p).css({"max-width":c+"px","max-height":h+"px"}),r.issearch&&this.createEvent(s.find("["+this.resultUlMarker+"]"),this.controlTypes.ptree.name,"click",window[this.ptool.pstaticEventFnName])},ptree.prototype.eventHandout=function(e,t){var n=this,r=$(t[this.ptool.eventCurrTargetName]),i=r.attr(this.ptool.libraryIdToHtml),s=t.type,o=$(t.currentTarget),u=this.ptool.getTypeAndChildTypeFromEle(r),a=ptree[i],f=a.attr,l=a.event||{};switch(s){case"click":if(o.attr(this.foldMarker)!=null){var c=o.parent().parent().next(),h=c.is(":hidden")?"slideDown":"slideUp";c[h](),o.text(this.foldIconObj[o.text()])}else if(o.attr(this.itemTitleMarker)!=null){f.number===1&&!o.hasClass(this.selCss)&&r.find("["+this.itemTitleMarker+"]").removeClass(this.selCss),o.toggleClass(this.selCss),t[this.eventOthAttribute]={state:o.hasClass(this.selCss)},this.executeEventCall(e,t,l.sel);var p=a[this.ptool.controlPrivateToProName]||[];if(o.hasClass(this.selCss))p.push(e);else for(var d=0;d<p.length;d++){var v=p[d];if(v.level===e.level&&v[f.item.text]===e[f.item.text]){p.splice(d,1);break}}a[this.ptool.controlPrivateToProName]=p,ptree[i]=a}else if(o.attr(this.resultUlMarker)!=null){var m=$(t.target);m[0].tagName!="LI"&&(m=m.parent()),m.toggleClass(this.selCss);var g=r[0],y=g[this.ptool.libraryToPro]||{},b=y[this.ptool.controlPrivateToProName],w=m.index();b[w][0].click()}else if(o.attr(this.operMarker)!=null)o.next().is(":visible")||$("["+this.operUlMarker+"]").hide(),o.next().toggle();else if(o.attr(this.operUlMarker)!=null){o.prev()[0].click();var E=$(t.target),S=E.index(),c=o.parent().parent().next(),x=c.find("["+this.itemTitleMarker+"]");if(S==1){var T=x.eq(0);T.hasClass(this.selCss)||T[0].click()}else for(var N=0;N<x.length;N++){var C=x.eq(N);switch(S){case 0:C.hasClass(this.selCss)||C[0].click();break;case 2:C.hasClass(this.selCss)&&C[0].click()}}}}},ptree.prototype.precover=function(e){var t=arguments[0],n=$(t);e=arguments[1]===!1?!1:!0,n.find("["+this.treeSearchMarker+"]").precover();if(e){n.find("["+this.itemTitleMarker+"]").removeClass(this.selCss);var r=n.attr(this.ptool.libraryIdToHtml),i=ptree[r];i[this.ptool.controlPrivateToProName]=[],ptree[r]=i}},ptree.prototype.psel=function(e){var t=arguments[0],n=$(t),r=n.attr(this.ptool.libraryIdToHtml),i=ptree[r],s=i[this.ptool.controlPrivateToProName]||[];if(arguments.length===1)return s;e=arguments[1]||{};var o=e.nodeId,u=e.isEvent===!1?!1:!0,a=e.type,f=n.find("["+this.itemTitleMarker+'="'+o+'"]');if(f.length==0)return!1;switch(a){case 0:u?(f.addClass(this.selCss),f[0].click()):f.removeClass(this.selCss);break;case 1:u?(f.removeClass(this.selCss),f[0].click()):f.addClass(this.selCss);break;case 2:u?f[0].click():f.toggleClass(this.selCss)}},ptree.searchPromptly=function(e){var t=new ptree,n=e[t.ptool.eventOthAttribute].key,r=$(e[t.ptool.eventCurrTargetName]),i=r.parent().next().find("["+t.treeRegionMarker+"]"),s=i.prev(),o=s.find("["+t.resultUlMarker+"]");if(!n){s.hide(),i.show();return}i.hide(),s.show();var u=i.find("["+t.itemTitleMarker+"]"),a=[],f="";for(var l=0;l<u.length;l++){var c=u.eq(l),h=c.find("["+t.itemTitleValMarker+"]").text();if(h.indexOf(n)==-1)continue;a.push(c);var p=t.ptool.splitStrByKey(n,h);p&&(f+='<li class="'+(c.hasClass(t.selCss)?t.selCss:"")+'">'+p.start+'<em class="per-searchbox-select_color">'+p.key+"</em>"+p.end+"</li>")}o.empty(),o.append(f);var d=s[0],v=d[t.ptool.libraryToPro]||{};v[t.ptool.controlPrivateToProName]=a,d[t.ptool.libraryToPro]=v};function ptime_template(){this.constructor=arguments.callee,this.calendarDefaultTimeTypeArr=["d","w","M","y","h","m","s"],this.calendarTimeTypeShow={d:"日",w:"周",M:"月",y:"年",h:"时",m:"分",s:"秒"},this.calendarCommonTimeArr=["d","pd","w","pw","M","pM","y","py"],this.calendarCommonTimeShow={d:"今天",pd:"昨天",w:"本周",pw:"上周",M:"本月",pM:"上月",y:"今年",py:"去年"},this.lockObj={c:"s",s:"c"},this.commonTimeLiMarker="commontimeli",this.contentNavigationLiMarker="navili",this.panelConMaxMarker="pcontm",this.panelConYearComboxMarker="yearbox",this.panelConCrossYearComboxMarker="crossyearbox",this.panelConMonthComboxMarker="monthbox",this.orientationMarker="orientationm",this.columnUlMarker="columnul",this.columnLiMarker="ival",this.selTimeShowRegionMarker="seltimeshowre",this.panelToggleMarker="arrowto",this.panelConHeaderQuickMarker="panelquickto",this.footLockMarker="footlock",this.contentMaxMarker="maxcon",this.headerWeekMarker="hdwkmr",this.stepUnitMarker="stepunit",this.stepValueMarker="stepval",this.tempSelTimeMarker="temptimeval",this.okBtnMarker="okt",this.timeTypeMarker="tmk",this.defaultMinYear=1900,this.defaultMaxYear=2099,this.oneDayMillSeconds=864e5,this.crossYearStep=12,this.weekUnit="th",this.dateSperator="-",this.timeSperator=":",this.hourSperator=" ",this.commonTimeSelCss="per-calendar_location_active",this.contentNavigationSelCss="per-calendar_details_active",this.columnSelCss="per-calendar_main_active",this.columnInCss="per-calendar_main_hover",this.toggleArrowCss="_calendar-arrows-avtive",this.calendarShowRegion='<div class="per-calendar-title"><div class="_time-left"><pbutton-white icon="l" click="ptime.headerQuickSelEvent" '+this.orientationMarker+'="'+this.ptool.orientation.left+'"></pbutton-white></div>'+'<div class="per-calendar-text" '+this.selTimeShowRegionMarker+">此处显示当前选择的时间</div>"+'<div class="_time-right"><pbutton-white '+this.orientationMarker+'="'+this.ptool.orientation.right+'" icon="r" click="ptime.headerQuickSelEvent"></pbutton-white></div></div>'}ptime_template.prototype=new persagyElement,ptime_template.prototype.getTemplateStr=function(e,t){var n=e.attr,r=n.panel;switch(t){case this.controlTypes.ptime.types[0]:var i=r.timetype||[],s="";for(var o=0;o<i.length;o++){var u=i[o],a=this.calendarTimeTypeShow[u],f,l,c="";switch(u){case this.calendarDefaultTimeTypeArr[3]:f=r.startyear,l=r.endyear;break;case this.calendarDefaultTimeTypeArr[2]:f=1,l=12;break;case this.calendarDefaultTimeTypeArr[0]:f=0,l=-2,c='click="ptime.formTimeDateHeaderEvent"';break;case this.calendarDefaultTimeTypeArr[4]:f=0,l=23;break;case this.calendarDefaultTimeTypeArr[5]:case this.calendarDefaultTimeTypeArr[6]:f=0,l=59}var h="<pcombobox-time "+this.timeTypeMarker+'="'+u+'" sel="ptime.formTimeSelEvent" isborder="true"><header prefix="'+a+'" '+c+'></header><item start="'+f+'" end="'+l+'"></item></pcombobox-time>';s+='<div class="time-box'+(u===this.calendarDefaultTimeTypeArr[4]?" hour-box":"")+'">'+h+"</div>"}return'<div {{id}}{{disabled}} class="per-time-chart" '+this.ptool.maxDivMarker+">"+s+"</div>";case this.controlTypes.ptime.types[1]:var p="";if(r.iscommontime){var d='<li class="per-calendar_location_tit">常用时间</li>';for(var o=0;o<r.commontime.length;o++)d+="<li "+this.commonTimeLiMarker+'="'+r.commontime[o]+'" class="per-calendar_location_item">'+this.calendarCommonTimeShow[r.commontime[o]]+"</li>";p='<div class="per-calendar_location"><ul>'+d+"</ul></div>"}var v="";for(var m=0;m<r.timetype.length;m++)v+='<li class="per-calendar_details_item" '+this.contentNavigationLiMarker+'="'+r.timetype[m]+'">'+this.calendarTimeTypeShow[r.timetype[m]]+"</li>";var g='<div class="per-calendar_details_nav"><ul>'+v+"</ul></div>",y=this.createPanel(this.ptool.orientation.left,e),b="",w="";r.double===!0&&(r.doubletoggle===!0&&(b='<div class="per-calendar-arrows"><div class="per-calendar-arrows_but" '+this.panelToggleMarker+">></div></div>"),w=this.createPanel(this.ptool.orientation.right,e));var E='<div class="per-calendar_details_con">'+y+b+w+"</div>",S='<div class="per-calendar_details_footer">'+(r.lock===!0?'<div class="per-calendar-lock"><em class="icon" '+this.footLockMarker+">"+this.lockObj.s+'</em><em style="display:none;">锁定步长为<em class="color countVal" '+this.stepValueMarker+'>0</em><em class="countDateType" '+this.stepUnitMarker+">日</em></em></div>":"")+'<div class="per-calendar-selecttime">已选时间：<em class="countTime" '+this.tempSelTimeMarker+">2016~2017</em></div>"+'<div class="per-calendar-but"><pbutton-blue text="确定" '+this.okBtnMarker+' click="ptime.timeOkEvent"></pbutton-blue></div></div>',x='<div class="per-calendar_details">'+g+E+S+"</div>",T='<div class="per-calendar-con" '+this.contentMaxMarker+">"+p+x+"</div>";return"<div "+this.ptool.maxDivMarker+' class="per-time-calendar" {{id}}>'+this.calendarShowRegion+T+"</div>"}},ptime_template.prototype.createPanel=function(e,t){var n=t.attr,r=n.panel;return'<div class="per-calendar_main" '+this.orientationMarker+'="'+e+'" '+this.panelConMaxMarker+">"+'<div class="per-calendar_main_menu">'+'<div class="_menu-icon _menu-prev" '+this.panelConHeaderQuickMarker+'="'+this.ptool.orientation.left+'" '+this.orientationMarker+'="'+e+'"><</div>'+'<div class="_menu-icon _menu-next" '+this.panelConHeaderQuickMarker+'="'+this.ptool.orientation.right+'" '+this.orientationMarker+'="'+e+'">></div>'+'<div class="per-calendar_combobox" '+this.panelConCrossYearComboxMarker+">"+'<pcombobox-time sel="ptime.panelTimeComboxSelEvent" isborder="false" '+this.orientationMarker+'="'+e+'"><header prefix="年"></header><item start="'+r.startyear+'" end="'+r.endyear+'" step="'+this.crossYearStep+'"></item></pcombobox-time></div>'+'<div class="per-calendar_combobox" '+this.panelConYearComboxMarker+">"+'<pcombobox-time sel="ptime.panelTimeComboxSelEvent" isborder="false" '+this.orientationMarker+'="'+e+'"><header prefix="年"></header><item start="'+r.startyear+'" end="'+r.endyear+'"></item></pcombobox-time></div>'+'<div class="per-calendar_combobox" '+this.panelConMonthComboxMarker+">"+'<pcombobox-time sel="ptime.panelTimeComboxSelEvent" isborder="false" '+this.orientationMarker+'="'+e+'"><header prefix="月"></header><item start="1" end="12"></item></pcombobox-time></div>'+"</div>"+'<div class="per-calendar-day">'+'<div class="per-calendar_main_week" '+this.headerWeekMarker+">"+'<ul><li class="per-calendar_main_item _week-item">日</li>'+'<li class="per-calendar_main_item _week-item">一</li>'+'<li class="per-calendar_main_item _week-item">二</li>'+'<li class="per-calendar_main_item _week-item">三</li>'+'<li class="per-calendar_main_item _week-item">四</li>'+'<li class="per-calendar_main_item _week-item">五</li>'+'<li class="per-calendar_main_item _week-item">六</li>'+"</ul></div>"+'<ul class="per-calendar-wrap_main" '+this.orientationMarker+'="'+e+'" '+this.columnUlMarker+"></ul></div></div>"};function ptime(){this.constructor=arguments.callee}ptime.prototype=new ptime_template,ptime.prototype.init=function(childType,objBind,jqElement){var attr=objBind.attr,event=objBind.event,css=objBind.css,jqPanelTarget=jqElement.find("panel"),timeTypeArr=(jqPanelTarget.attr("timetype")||"").split(""),commonTimeArr=eval(jqPanelTarget.attr("commontime"));attr.panel={startyear:parseInt(jqPanelTarget.attr("startyear"))||this.defaultMinYear,endyear:parseInt(jqPanelTarget.attr("endyear"))||this.defaultMaxYear,"double":jqPanelTarget.attr("double")==="false"?!1:!0,doubletoggle:jqPanelTarget.attr("doubletoggle")==="false"?!1:!0,lock:jqPanelTarget.attr("lock")==="false"?!1:!0,timetype:timeTypeArr.length>0?timeTypeArr:this.calendarDefaultTimeTypeArr,commontime:commonTimeArr||this.calendarCommonTimeArr,iscommontime:jqPanelTarget.attr("iscommontime")==="false"?!1:!0};var templateStr=this.getTemplateStr(objBind,childType);this.renderView(templateStr,this.controlTypes.ptime.name,childType,objBind,jqElement)},ptime.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e);if(n===this.controlTypes.ptime.types[1]){this.createEvent(s.find("["+this.selTimeShowRegionMarker+"]"),this.controlTypes.ptime.name,"click",window[this.ptool.pstaticEventFnName]);var o=s.find("["+this.commonTimeLiMarker+"]");for(var u=0;u<o.length;u++)this.createEvent(o.eq(u),this.controlTypes.ptime.name,"click",window[this.ptool.pstaticEventFnName]);var a=s.find("["+this.contentNavigationLiMarker+"]");for(var u=0;u<a.length;u++){var f=a.eq(u);this.createEvent(f,this.controlTypes.ptime.name,"click",window[this.ptool.pstaticEventFnName])}var l=s.find("["+this.panelConHeaderQuickMarker+"]");for(var u=0;u<l.length;u++)this.createEvent(l.eq(u),this.controlTypes.ptime.name,"click",window[this.ptool.pstaticEventFnName]);var c=s.find("["+this.panelToggleMarker+"]");this.createEvent(c,this.controlTypes.ptime.name,"click",window[this.ptool.pstaticEventFnName]);var h=s.find("["+this.footLockMarker+"]");this.createEvent(h,this.controlTypes.ptime.name,"click",window[this.ptool.pstaticEventFnName]);var p=s.find("["+this.columnUlMarker+"]");for(var u=0;u<p.length;u++)this.createEvent(p.eq(u),this.controlTypes.ptime.name,"click",window[this.ptool.pstaticEventFnName]);var d=a.eq(0).attr(this.contentNavigationLiMarker);s.psel({timeType:d,startTime:(new Date).getTime(),endTime:(new Date).getTime()},!1)}else{var v=new Date,m=v.getMonthLength(),g=v.getFullYear(),y=v.getMonth()+1,b=s.find("["+this.timeTypeMarker+'="'+this.calendarDefaultTimeTypeArr[0]+'"]');b.length>0&&this.formTimeDateListReset(g,y,b),s.psel({y:g,M:y,d:v.getDate(),h:v.getHours(),m:v.getMinutes(),s:v.getSeconds()},!1)}},ptime.prototype.eventHandout=function(e,t){function v(){var e=o.attr(n.contentNavigationLiMarker);if(d.timeType==e)return;o.addClass(n.contentNavigationSelCss).siblings().removeClass(n.contentNavigationSelCss);var t=r.find("["+n.panelConYearComboxMarker+"]"),s=r.find("["+n.panelConCrossYearComboxMarker+"]"),u=r.find("["+n.panelConMonthComboxMarker+"]"),a=r.find("["+n.headerWeekMarker+"]");t.css({width:"60px"});var f=r.find("["+n.panelConMaxMarker+"]["+n.orientationMarker+'="'+n.ptool.orientation.right+'"]'),l=f.attr(n.panelConMaxMarker)==="false"?!0:!1,c=l?d.startTimeMsec:d.startTimeMsec||d.endTimeMsec,h=l?null:d.endTimeMsec||d.startTimeMsec;switch(e){case n.calendarDefaultTimeTypeArr[0]:s.hide(),t.show(),u.show(),a.show();break;case n.calendarDefaultTimeTypeArr[1]:s.hide(),t.show(),u.show(),a.show();var p=new Date(c),v=p.getWeekStartAndEnd();c=v.startTime;if(h){var m=new Date(h),g=m.getWeekStartAndEnd();h=g.endTime}break;case n.calendarDefaultTimeTypeArr[2]:u.hide(),a.hide(),s.hide(),t.show();var p=new Date(c);p.setDate(1),c=p.getTime();if(h){var m=new Date(h),y=m.getMonthLength();m.setDate(y),h=m.getTime()}break;case n.calendarDefaultTimeTypeArr[3]:t.hide(),u.hide(),a.hide(),s.css({width:"auto"}),s.show();var p=new Date(c);p.setMonth(0),p.setDate(1),c=p.getTime();if(h){var m=new Date(h);m.setMonth(11),m.setDate(31),h=m.getTime()}}n.setStoreTime({timeType:e,startTimeMsec:c,endTimeMsec:h,ele:i}),n.setConHeadComboxVal(r),n.calendarItem(r,n.ptool.orientation.left),n.calendarItem(r,n.ptool.orientation.right),n.calendarItemColor(r,n.ptool.orientation.left),n.calendarItemColor(r,n.ptool.orientation.right),n.calendarCountVal(r)}function m(){var e=o.attr(n.orientationMarker),t=o.attr(n.panelConHeaderQuickMarker),i=r.find("["+n.panelConYearComboxMarker+"]").find("["+n.orientationMarker+'="'+e+'"]'),s=r.find("["+n.panelConMonthComboxMarker+"]").find("["+n.orientationMarker+'="'+e+'"]'),u=r.find("["+n.panelConCrossYearComboxMarker+"]").find("["+n.orientationMarker+'="'+e+'"]'),a=i.psel().index,f=s.psel().index,l=u.psel().index,c=p-h;switch(d.timeType){case n.calendarDefaultTimeTypeArr[0]:case n.calendarDefaultTimeTypeArr[1]:switch(t){case n.ptool.orientation.left:--f;if(f<0){f=11,--a;if(a<0)return}break;case n.ptool.orientation.right:++f;if(f>11){f=0,++a;if(a>c)return}}s.psel(f,!1),i.psel(a,!0);break;case n.calendarDefaultTimeTypeArr[2]:switch(t){case n.ptool.orientation.left:--a;if(a<0)return;case n.ptool.orientation.right:++a;if(a>c)return}i.psel(a,!0);break;case n.calendarDefaultTimeTypeArr[3]:var v=(p+1-h)/n.crossYearStep-1;switch(t){case n.ptool.orientation.left:--l;if(l<0)return;case n.ptool.orientation.right:++l;if(l>v)return}u.psel(l,!0)}}function g(){var e=$(t.target),s=e.attr(n.columnLiMarker);s==null&&(e=e[0].parent()),s=parseInt(e.attr(n.columnLiMarker));var u=o.attr(n.orientationMarker),a=r.find("["+n.panelConYearComboxMarker+"]").find("["+n.orientationMarker+'="'+u+'"]'),f=r.find("["+n.panelConMonthComboxMarker+"]").find("["+n.orientationMarker+'="'+u+'"]'),l,c,p;switch(d.timeType){case n.calendarDefaultTimeTypeArr[0]:case n.calendarDefaultTimeTypeArr[1]:l=h+a.psel().index,c=f.psel().index+1,p=s;break;case n.calendarDefaultTimeTypeArr[2]:l=h+a.psel().index,c=s,p=u==n.ptool.orientation.left?1:(new Date(l,c-1,1)).getMonthLength();break;case n.calendarDefaultTimeTypeArr[3]:l=s,c=u==n.ptool.orientation.left?1:12,p=u==n.ptool.orientation.left?1:31}var v=(new Date(l,c-1,p)).getTime(),m=u==n.ptool.orientation.left?v:d.startTimeMsec,g=u==n.ptool.orientation.right?v:d.endTimeMsec;n.setStoreTime({timeType:d.timeType,startTimeMsec:m,endTimeMsec:g,ele:i}),n.calendarItemColor(r,n.ptool.orientation.left),n.calendarItemColor(r,n.ptool.orientation.right),n.calendarCountVal(r)}function y(){var e=o.parent(),t=e.next(),i=t.is(":hidden"),s=r.find("["+n.footLockMarker+"]");i?(t.show(),t.attr(n.panelConMaxMarker,"true"),s.parent().show(),e.removeClass(n.toggleArrowCss),s.parent().next().css({right:"120px"}),n.calendarItem(r,n.ptool.orientation.right)):(t.hide(),t.attr(n.panelConMaxMarker,"false"),s.parent().hide(),s.next().hide(),s.text(n.lockObj.s),e.addClass(n.toggleArrowCss),s.parent().next().css({right:"auto"}),d.endTimeMsec=null,n.setStoreTime(d),n.calendarItemColor(r,n.ptool.orientation.left),n.calendarCountVal(r))}function b(){var e=o.text(),t=n.lockObj[e];o.text(t);switch(t){case n.lockObj.s:o.next().hide();break;default:o.next().show()}}function w(){var e=o.attr(n.commonTimeLiMarker),t,s,u;switch(e){case n.calendarCommonTimeArr[0]:case n.calendarCommonTimeArr[1]:t=n.calendarDefaultTimeTypeArr[0],u=new Date,e===n.calendarCommonTimeArr[1]&&u.setDate(u.getDate()-1);break;case n.calendarCommonTimeArr[2]:case n.calendarCommonTimeArr[3]:t=n.calendarDefaultTimeTypeArr[1],u=new Date,s=u.getWeekStartAndEnd().startTime,u=new Date(s),e===n.calendarCommonTimeArr[3]&&u.setDate(u.getDate()-7);break;case n.calendarCommonTimeArr[4]:case n.calendarCommonTimeArr[5]:t=n.calendarDefaultTimeTypeArr[2],u=new Date,e===n.calendarCommonTimeArr[5]&&u.setMonth(u.getMonth()-1),u.setDate(1);break;case n.calendarCommonTimeArr[6]:case n.calendarCommonTimeArr[7]:t=n.calendarDefaultTimeTypeArr[3],u=new Date,e===n.calendarCommonTimeArr[7]&&u.setFullYear(u.getFullYear()-1),u.setMonth(0),u.setDate(1)}u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0),s=u.getTime(),n.setStoreTime({timeType:"_temp",startTimeMsec:s,endTimeMsec:null,ele:i,isReal:!0});var a=r.find("["+n.panelConMaxMarker+"]["+n.orientationMarker+'="'+n.ptool.orientation.right+'"]'),f=a.attr(n.panelConMaxMarker)==="false"?!0:!1;f||r.find("["+n.panelToggleMarker+"]")[0].click(),r.find("["+n.contentNavigationLiMarker+'="'+t+'"]')[0].click(),r.find("["+n.okBtnMarker+"]")[0].click()}var n=this,r=$(t[n.ptool.eventCurrTargetName]),i=r[0],s=t.type,o=$(t.currentTarget),u=n.ptool.getTypeAndChildTypeFromEle(r),a=r.attr(n.ptool.libraryIdToHtml),f=ptime[a],l=f.attr.panel,c=f.event||{},h=l.startyear,p=l.endyear,d=n.getStoreTime(i).temp;d.ele=i;switch(s){case"click":o.attr(n.selTimeShowRegionMarker)!=null?r.find("["+this.contentMaxMarker+"]").toggle():o.attr(n.contentNavigationLiMarker)!=null?v():o.attr(n.panelConHeaderQuickMarker)!=null?m():o.attr(n.columnUlMarker)!=null?g():o.attr(n.panelToggleMarker)!=null?y():o.attr(n.footLockMarker)!=null?b():o.attr(n.commonTimeLiMarker)!=null&&w()}},ptime.prototype.setConHeadComboxVal=function(e){var t=e.find("["+this.panelConYearComboxMarker+"]"),n=e.find("["+this.panelConCrossYearComboxMarker+"]"),r=e.find("["+this.panelConMonthComboxMarker+"]"),i=t.find("["+this.orientationMarker+'="'+this.ptool.orientation.left+'"]'),s=n.find("["+this.orientationMarker+'="'+this.ptool.orientation.left+'"]'),o=r.find("["+this.orientationMarker+'="'+this.ptool.orientation.left+'"]'),u=t.find("["+this.orientationMarker+'="'+this.ptool.orientation.right+'"]'),a=n.find("["+this.orientationMarker+'="'+this.ptool.orientation.right+'"]'),f=r.find("["+this.orientationMarker+'="'+this.ptool.orientation.right+'"]'),l=this.getStoreTime(e[0]).temp,c=l.startTimeMsec?new Date(l.startTimeMsec):null,h=null;if(l.endTimeMsec){var p=l.timeType===this.calendarDefaultTimeTypeArr[1]?(new Date(l.endTimeMsec)).getWeekStartAndEnd().startTime:l.endTimeMsec;h=new Date(p)}switch(l.timeType){case this.calendarDefaultTimeTypeArr[0]:case this.calendarDefaultTimeTypeArr[1]:if(c){var d=c.getMonth();o.psel(d,!1)}if(h){var v=h.getMonth();f.psel(v,!1)};case this.calendarDefaultTimeTypeArr[2]:if(c){var m=c.getFullYear()+"年";i.psel(m,!1)}if(h){var g=h.getFullYear()+"年";u.psel(g,!1)}break;case this.calendarDefaultTimeTypeArr[3]:var y=e.attr(this.ptool.libraryIdToHtml),b=ptime[y],w=b.attr.panel,E=w.startyear,S=w.endyear,x=this.crossYearStep,T=0,N=0,m=c?c.getFullYear():null,g=h?h.getFullYear():null,C=c?!1:!0,k=h?!1:!0;for(var L=E;L<=S;L++){var A=L;L=L+x-1;var O=L;m&&m>=A&&m<=O&&(C=!0),g&&g>=A&&g<=O&&(k=!0);if(C&&k)break;C||++T,k||++N}m&&s.psel(T,!1),g&&a.psel(N,!1)}},ptime.prototype.calendarItemColor=function(e,t,n){n=n||!1;var r=e.find("["+this.columnUlMarker+"]["+this.orientationMarker+'="'+t+'"]').children(),i,s,o=headerMinute=headerSecond=0,u=this.getYearMonthFromConHead(e),a=this.getStoreTime(e[0]).temp,f=a.startTimeMsec,l=a.endTimeMsec,c=a.timeType,h,p,d,v;switch(t){case this.ptool.orientation.left:i=u.startYear1,s=u.month1,c===this.calendarDefaultTimeTypeArr[1]&&(d=a.startTimeMsec,d&&(v=(new Date(d)).getWeekStartAndEnd().endTime));break;case this.ptool.orientation.right:i=u.startYear2,s=u.month2,c===this.calendarDefaultTimeTypeArr[1]&&(v=a.endTimeMsec,v&&(d=(new Date(v)).getWeekStartAndEnd().startTime))}if(c===this.calendarDefaultTimeTypeArr[1]){var m=(new Date(i,s-1,1)).getWeekArr();f&&(h=(new Date(f)).getWeekStartAndEnd().endTime),l&&(p=(new Date(l)).getWeekStartAndEnd().startTime)}for(var g=0;g<r.length;g++){var y=r.eq(g);y.removeClass(this.columnSelCss+" "+this.columnInCss);if(n)continue;var b;switch(c){case this.calendarDefaultTimeTypeArr[0]:b=(new Date(i,s-1,g+1,o,headerMinute,headerSecond,0)).getTime();break;case this.calendarDefaultTimeTypeArr[1]:var w=m[g];if(a.startTimeMsec&&a.endTimeMsec&&w.startTime>h&&w.endTime<p){y.addClass(this.columnInCss);continue}w.startTime==d&&w.endTime==v&&y.addClass(this.columnSelCss);continue;case this.calendarDefaultTimeTypeArr[2]:var E=t===this.ptool.orientation.left?1:(new Date(i,g,1)).getMonthLength();b=(new Date(i,g,E,o,headerMinute,headerSecond,0)).getTime();break;case this.calendarDefaultTimeTypeArr[3]:var S,x;t===this.ptool.orientation.left?(S=0,x=1):(S=11,x=31),b=(new Date(i+g,S,x,o,headerMinute,headerSecond,0)).getTime()}if(f&&l&&b>f&&b<l){y.addClass(this.columnInCss);continue}(b===f||b===l)&&y.addClass(this.columnSelCss)}},ptime.prototype.calendarItem=function(e,t){var n=this,r=e.find("["+this.columnUlMarker+"]["+this.orientationMarker+'="'+t+'"]');r.html(n.calendarItemHtml(e,t))},ptime.prototype.calendarItemHtml=function(e,t){var n,r,i,s=this.getYearMonthFromConHead(e);switch(t){case this.ptool.orientation.left:n=s.startYear1,r=s.endYear1,i=s.month1;break;case this.ptool.orientation.right:n=s.startYear2,r=s.endYear2,i=s.month2}var o=this.getStoreTime(e[0]).temp,u=o.timeType;if(u===this.calendarDefaultTimeTypeArr[0]||u===this.calendarDefaultTimeTypeArr[1])var a=new Date(n,i-1,1);var f="";switch(u){case this.calendarDefaultTimeTypeArr[0]:var l=a.getDay(),c=a.getMonthLength();for(var h=1;h<=c;h++){var p=h==1?' style = "margin-left:'+l*30+'px"':"";f+='<li class="per-calendar_main_item" '+this.columnLiMarker+'="'+h+'"'+p+" "+this.orientationMarker+'="'+t+'">'+h+"</li>"}return f;case this.calendarDefaultTimeTypeArr[1]:var d=a.getWeekArr();for(h=0;h<d.length;h++){var v=d[h],m=new Date(v.startTime),g=new Date(v.endTime),y=m.getDate();y=y<10?"0"+y:y;var b=m.format("M.d")+"~"+g.format("M.d");f+='<li class="per-calendar_main_item _week_item" '+this.columnLiMarker+'="'+y+'" '+this.orientationMarker+'="'+t+'"><em>第'+(h+1)+"周</em>"+b+"</li>"}return f;case this.calendarDefaultTimeTypeArr[2]:for(h=1;h<=12;h++)f+='<li class="per-calendar_month_item" '+this.columnLiMarker+'="'+h+'" '+this.orientationMarker+'="'+t+'">'+h+"月</li>";return f;case this.calendarDefaultTimeTypeArr[3]:for(h=n;h<=r;h++)f+='<li class="per-calendar_month_item" '+this.columnLiMarker+'="'+h+'" '+this.orientationMarker+'="'+t+'">'+h+"年</li>";return f}},ptime.prototype.calendarCountVal=function(e){var t=this.getStoreTime(e[0]).temp,n=t.timeType,r=t.startTimeMsec||t.endTimeMsec,i=t.startTimeMsec&&t.endTimeMsec?t.endTimeMsec:0,s=new Date(r),o=new Date(i);if(i){var u=new Date(i);u.setDate(u.getDate()+1);var a=u.getTime()}var f="",l="",c=0;switch(n){case this.calendarDefaultTimeTypeArr[0]:f=s.format("y.M.d"),i?(l=o.format("y.M.d"),c=(a-r)/this.oneDayMillSeconds):c=1;break;case this.calendarDefaultTimeTypeArr[1]:f=s.format("y.M.");var h=s.getWeekStartAndEnd().week;h=h<10?"0"+h:h,f+=h+this.weekUnit;if(i){var p=o.getWeekStartAndEnd();l=(new Date(p.startTime)).format("y.M.");var d=p.week;d=d<10?"0"+d:d,l+=d+this.weekUnit,c=(a-r)/this.oneDayMillSeconds/7}else c=1;break;case this.calendarDefaultTimeTypeArr[2]:f=s.format("y.M");if(i){l=o.format("y.M");var v=(o.getFullYear()-s.getFullYear()-1)*12;c=v+(12-s.getMonth())+(o.getMonth()+1)}else c=1;break;case this.calendarDefaultTimeTypeArr[3]:f=s.format("y"),i?(l=o.format("y"),c=o.getFullYear()-s.getFullYear()+1):c=1}var m=e.find("["+this.stepUnitMarker+"]");m.text(this.calendarTimeTypeShow[n]);var g=e.find("["+this.stepValueMarker+"]");g.text(c);var y=f+(l?"~"+l:""),b=e.find("["+this.tempSelTimeMarker+"]");b.text(y)},ptime.prototype.getYearMonthFromConHead=function(e){var t=this.getStoreTime(e[0]).temp,n=e.attr(this.ptool.libraryIdToHtml),r=ptime[n],i=r.attr.panel,s=i.startyear,o=i.endyear,u,a,f,l,c,h,p=e.find("["+this.panelConYearComboxMarker+"]"),d=e.find("["+this.panelConCrossYearComboxMarker+"]"),v=e.find("["+this.panelConMonthComboxMarker+"]"),m=p.find("["+this.orientationMarker+'="'+this.ptool.orientation.left+'"]'),g=d.find("["+this.orientationMarker+'="'+this.ptool.orientation.left+'"]'),y=v.find("["+this.orientationMarker+'="'+this.ptool.orientation.left+'"]'),b=p.find("["+this.orientationMarker+'="'+this.ptool.orientation.right+'"]'),w=d.find("["+this.orientationMarker+'="'+this.ptool.orientation.right+'"]'),E=v.find("["+this.orientationMarker+'="'+this.ptool.orientation.right+'"]');switch(t.timeType){case this.calendarDefaultTimeTypeArr[0]:case this.calendarDefaultTimeTypeArr[1]:f=y.psel().index+1,h=E.psel().index+1;case this.calendarDefaultTimeTypeArr[2]:u=s+m.psel().index,l=s+b.psel().index;break;case this.calendarDefaultTimeTypeArr[3]:var S=this.crossYearStep,x=g.psel().index*S,T=w.psel().index*S;u=s+x,a=u+S-1,l=s+T,c=l+S-1}return{startYear1:u,endYear1:a,month1:f,startYear2:l,endYear2:c,month2:h}},ptime.prototype.getStoreTime=function(e){var t=e[this.ptool.libraryToPro]||{},n=t[this.ptool.controlPrivateToProName]||{};return{temp:n.temp||{},real:n.real||{}}},ptime.prototype.setStoreTime=function(e){var t=e.ele,n=t[this.ptool.libraryToPro]||{},r=n[this.ptool.controlPrivateToProName]||{},i=r.temp||{},s=r.real||{},o=e.isReal||!1;i.timeType=e.timeType||i.timeType,i.startTimeMsec=e.startTimeMsec,i.endTimeMsec=e.endTimeMsec;if(i.startTimeMsec){var u=new Date(i.startTimeMsec);u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0),i.startTimeMsec=u.getTime(),i.startWeekIndex=(new Date(i.startTimeMsec)).getWeekStartAndEnd().week}else i.startWeekIndex="";if(i.endTimeMsec){var u=new Date(i.endTimeMsec);u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0),i.endTimeMsec=u.getTime(),i.endWeekIndex=(new Date(i.endTimeMsec)).getWeekStartAndEnd().week}else i.endWeekIndex="";o&&(s.timeType=i.timeType,s.startTimeMsec=i.startTimeMsec,s.endTimeMsec=i.endTimeMsec,s.startWeekIndex=i.startWeekIndex,s.endWeekIndex=i.endWeekIndex),r.temp=i,r.real=s,n[this.ptool.controlPrivateToProName]=r,t[this.ptool.libraryToPro]=n,this.headerIsQuick($(t),i.startTimeMsec,i.endTimeMsec)},ptime.prototype.psel=function(e,t){var n=arguments[0];e=arguments[1]||{},t=arguments[2]===!1?!1:!0;var r=$(n),i=this.ptool.getTypeAndChildTypeFromEle(n).childType,s=r.attr(this.ptool.libraryIdToHtml),o=ptime[s],u=o.attr.panel;if(arguments.length==1){if(i===this.controlTypes.ptime.types[1]){var a=this.getStoreTime(n).real,f=a.startTimeMsec||a.endTimeMsec,l=a.endTimeMsec&&a.startTimeMsec?a.endTimeMsec:null,c=a.timeType,h=f,p,d,v,m;if(l)m=new Date(l);else switch(a.timeType){case this.calendarDefaultTimeTypeArr[0]:m=new Date(f);break;case this.calendarDefaultTimeTypeArr[1]:var g=(new Date(f)).getWeekStartAndEnd().endTime;m=new Date(g);break;case this.calendarDefaultTimeTypeArr[2]:m=new Date(f),m.setDate(m.getMonthLength());break;case this.calendarDefaultTimeTypeArr[3]:m=new Date(f),m.setMonth(11),m.setDate(31)}return m.setHours(23),m.setMinutes(59),m.setSeconds(59),m.setMilliseconds(0),p=m.getTime(),v=m.getWeekStartAndEnd().week,d=p+1e3,{timeType:a.timeType,startTime:h,endTime:p,realEndTime:d,week:v}}var y="",b=r.find("["+this.timeTypeMarker+"]");for(var w=0;w<b.length;w++){var E=b.eq(w),S=E.attr(this.timeTypeMarker);switch(S){case this.calendarDefaultTimeTypeArr[3]:x(this.dateSperator,u.startyear+E.psel().index);break;case this.calendarDefaultTimeTypeArr[2]:x(this.dateSperator,E.psel().index+1);break;case this.calendarDefaultTimeTypeArr[0]:x(this.dateSperator,E.psel().index+1);break;case this.calendarDefaultTimeTypeArr[4]:x(this.hourSperator,E.psel().index);break;case this.calendarDefaultTimeTypeArr[5]:case this.calendarDefaultTimeTypeArr[6]:x(this.timeSperator,E.psel().index)}}return{startTime:y};function x(e,t){t=t<10?"0"+t:t,y+=(y.length==0?"":e)+t}}if(i===this.controlTypes.ptime.types[1]){if(e.startTime||e.endTime){var T=e.startTime?(new Date(e.startTime)).getTime():null,N=e.endTime?(new Date(e.endTime)).getTime():null;if(e.timeType){var C=r.find("["+this.contentNavigationLiMarker+'="'+e.timeType+'"]');C.length>0&&(this.setStoreTime({startTimeMsec:T,endTimeMsec:N,ele:n}),C[0].click())}else this.setStoreTime({startTimeMsec:T,endTimeMsec:N,ele:n}),this.setConHeadComboxVal(r),this.calendarItem(r,this.ptool.orientation.left),this.calendarItem(r,this.ptool.orientation.right),this.calendarItemColor(r,this.ptool.orientation.left),this.calendarItemColor(r,this.ptool.orientation.right),this.calendarCountVal(r);this.okEdChange(r)}}else for(var w=0;w<this.calendarDefaultTimeTypeArr.length;w++){var S=this.calendarDefaultTimeTypeArr[w],k=r.find("["+this.timeTypeMarker+'="'+S+'"]');if(k.length==0)continue;var L=e[S],A;switch(S){case this.calendarDefaultTimeTypeArr[3]:A=L-u.startyear,k.psel(A,!1);break;case this.calendarDefaultTimeTypeArr[2]:A=L-1;break;case this.calendarDefaultTimeTypeArr[0]:A=L-1;break;case this.calendarDefaultTimeTypeArr[4]:A=L}k.psel(A,!1)}t&&this.executeSel(r)},ptime.prototype.plock=function(e,t){var n=arguments[0],r=$(n);r.psel(e,t);var i=r.find("["+this.footLockMarker+"]");i.length>0&&i[0].click()},ptime.prototype.headerIsQuick=function(e,t,n){return;var r,i,s,o,u,a,f,l,c,h,p,d},ptime.prototype.findMaxJqTarget=function(e){var t=$(e),n=0;while(t.attr(this.ptool.maxDivMarker)==null){t=t.parent(),++n;if(n>50)break}return n>50?!1:t},ptime.prototype.formTimeDateListReset=function(e,t,n){var r=(new Date(e,t-1,1)).getMonthLength();(new pcombobox).resetList(n,1,r,this.calendarTimeTypeShow.d)},ptime.prototype.okEdChange=function(e){var t=e[0],n=this.getStoreTime(t).temp;n.isReal=!0,n.ele=t,this.setStoreTime(n);var r=e.find("["+this.tempSelTimeMarker+"]").text(),i=e.find("["+this.selTimeShowRegionMarker+"]");i.text(r),e.find("["+this.contentMaxMarker+"]").is(":hidden")||i[0].click()},ptime.prototype.executeSel=function(e,t){t=t||{};var n=e.attr(this.ptool.libraryIdToHtml),r=ptime[n],i=r.event||{};if(i.sel){var s=e.psel();t[this.ptool.eventOthAttribute]=s,this.executeEventCall(null,t,i.sel)}},ptime.headerQuickSelEvent=function(e){var t=new ptime,n=$(e[t.ptool.eventCurrTargetName]),r=t.findMaxJqTarget(n.parent());if(!r)return;var i=r[0],s=n.attr(t.orientationMarker),o=t.getStoreTime(i).real,u=o.startTimeMsec,a=o.endTimeMsec;if(u&&a){var f=a-u;s==t.ptool.orientation.left?(a=u-t.oneDayMillSeconds,u=a-f):(u=a+t.oneDayMillSeconds,a=u+f)}else{var l=o.startTimeMsec||o.endTimeMsec;switch(o.timeType){case t.calendarDefaultTimeTypeArr[0]:l=s==t.ptool.orientation.left?l-t.oneDayMillSeconds:l+t.oneDayMillSeconds;break;case t.calendarDefaultTimeTypeArr[1]:l=s==t.ptool.orientation.left?l-t.oneDayMillSeconds*7:l+t.oneDayMillSeconds*7;break;case t.calendarDefaultTimeTypeArr[2]:var c=new Date(l),h=s==t.ptool.orientation.left?c.getDate()-1:c.getDate()+1;c.setDate(h),l=c.getTime();break;case t.calendarDefaultTimeTypeArr[3]:c=new Date(l);var p=s==t.ptool.orientation.left?c.getFullYear()-1:c.getFullYear()+1;c.setFullYear(p),l=c.getTime()}u?u=l:a=l}var d=r.attr(t.ptool.libraryIdToHtml),v=ptime[d],m=v.attr.panel,g=m.startyear,y=m.endyear;if(u){c=new Date(u);var b=c.getFullYear();if(b<g||b>y)return}if(a){c=new Date(a),b=c.getFullYear();if(b<g||b>y)return}o.startTimeMsec=u,o.endTimeMsec=a,o.isReal=!0,o.ele=i,t.setStoreTime(o),t.setConHeadComboxVal(r),t.calendarItem(r,t.ptool.orientation.left),t.calendarItem(r,t.ptool.orientation.right),t.calendarItemColor(r,t.ptool.orientation.left),t.calendarItemColor(r,t.ptool.orientation.right),t.calendarCountVal(r),r.find("["+t.okBtnMarker+"]")[0].click()},ptime.panelTimeComboxSelEvent=function(e){var t=new ptime,n=$(e[t.ptool.eventCurrTargetName]),r=n.attr(t.orientationMarker),i=t.findMaxJqTarget(n.parent());if(!i)return;t.calendarItem(i,r),t.calendarItemColor(i,r),t.calendarItemColor(i,r)},ptime.timeOkEvent=function(e){var t=new ptime,n=$(e[t.ptool.eventCurrTargetName]),r=t.findMaxJqTarget(n.parent());if(!r)return;t.okEdChange(r),t.executeSel(r,e)},ptime.formTimeSelEvent=function(e){var t=new ptime,n=$(e[t.ptool.eventCurrTargetName]),r=t.findMaxJqTarget(n.parent());if(!r)return;t.executeSel(r,e)},ptime.formTimeDateHeaderEvent=function(e){var t=new ptime,n=$(e[t.ptool.eventCurrTargetName]),r=t.findMaxJqTarget(n.parent());if(!r)return;var i=r.attr(t.ptool.libraryIdToHtml),s=ptime[i],o=s.attr.panel,u=r.find("["+t.timeTypeMarker+'="'+t.calendarDefaultTimeTypeArr[2]+'"]');if(u.length==0)return;var a=r.find("["+t.timeTypeMarker+'="'+t.calendarDefaultTimeTypeArr[3]+'"]');if(a.length==0)return;var f=u.psel().index+1,l=o.startyear+a.psel().index,c=(new Date(l,f-1,1)).getMonthLength(),h=n.psel().index+1;t.formTimeDateListReset(l,f,n);var p=Math.min(c,h);n.psel(p-1,!1)};function plogin_template(){this.loginMarker="login",this.formMarker="formm",this.normal="<div "+this.ptool.maxDivMarker+"{{id}}"+' class="per-login-normal"><form '+this.formMarker+' method="post" action="/'+pconst.requestType.plogin+'"><div class="per-login-normal-con"><div class="per-login-normal_title ">',this.mian=' </div><div class="per-login-normal_main"><input type="text" placeholder="用户名" name="name"><input type="password" placeholder="密码" name="pass" class="marB20"></div><input type="button" value="登录" '+this.loginMarker+' class="per-login-normal_button"></div><div class="per-login-ICP" ></div></form></div>'}plogin_template.prototype=new persagyElement,plogin_template.prototype.getTemplateStr=function(e,t){var n=e.attr,r=n.panel;return this.mainTitle="<b>"+r.title+"</b><em>"+r.subtitle+" </em>",this[t]+this.mainTitle+this.mian};function plogin(){this.constructor=arguments.callee}plogin.prototype=new plogin_template,plogin.prototype.init=function(e,t,n){var r=t.attr,i=n.find("panel");r.panel={title:i.attr("title"),subtitle:i.attr("subtitle")};var s=this.getTemplateStr(t,e);this.renderView(s,this.controlTypes.plogin.name,e,t,n)},plogin.prototype.rendered=function(e,t,n){var r=t.attr,i=t.event,s=ptool.getJqElement(e),o=s.find("["+this.loginMarker+"]");this.createEvent(o,this.controlTypes.plogin.name,"click",window[this.ptool.pstaticEventFnName])},plogin.prototype.eventHandout=function(e,t){var n=this,r=$(t[this.ptool.eventCurrTargetName]),i=t.type;i=="click"&&r.find("["+this.formMarker+"]").submit()};function pframe_template(){this.constructor=arguments.callee,this.menuLiMarker="menuli",this.navigationMarker="nav",this.subTitleMarker="smt",this.userNameMarkder="unm",this.iframeMarker="ifm",this.navigationActiveMarker="nam",this.userMenuItemMarker="umim",this.systemManagerMarker="smm",this.navigationMenuUlMarker="nmum",this.navigationNoActiveCss="active"}pframe_template.prototype=new persagyElement,pframe_template.prototype.getTemplateStr=function(e,t){var n=e.attr,r=n.header,i=n.item,s="";i.manageText&&(s="<div "+this.systemManagerMarker+' class="per-frame-set"><i {{icon}}></i><em {{text}}>项目管理</em></div>',s=this.joinHtmlToBindByAttrCss(s,{text:i.manageText,icon:i.manageIcon}));var o="";if(i.comboxHtml){o='<div class="per-frame-combobox">'+i.comboxHtml+"</div>";var u=$(o);u.children().attr("isborder","false"),o=u[0].outerHTML}var a="<li {{click}} "+this.menuLiMarker+"><b>></b><em"+(i.icon?" {{icon}}":"")+"></em><span {{text}}></span></li>";a=this.joinHtmlToBindByAttrCss(a,{text:i.text,icon:i.icon},null,null,!0),a=this.createForBind(a,i.child,!0),a="<ul "+this.navigationMenuUlMarker+">"+a+"</ul>";var f='<div class="per-frame-nav_temp"><div class="temp-title" {{text}}></div>'+a+"</div>";f=this.joinHtmlToBindByAttrCss(f,{text:i.text},null,null,!0),f=this.createForBind(f,i.datasource);var l='<div class="per-frame-nav-wrap">'+f+"</div>",c='<div class="per-frame-nav blckScroll" '+this.navigationMarker+">"+s+o+l+"</div>",h='<span class="pic"></span>';if(r.uhead){var p="'url('+"+r.uhead+"+')'";h=this.createStyleBind(h,{"background-image":p})}var d="<em {{text}}></em>";d=this.joinHtmlToBindByAttrCss(d,{text:r.uname});var v="<span {{text}}></span>";v=this.joinHtmlToBindByAttrCss(v,{text:r.title});var m="<li "+this.userMenuItemMarker+" {{click}}><em {{text}}></em></li>";m=this.joinHtmlToBindByAttrCss(m,{text:r.text||""},null,null,!0),m=this.createForBind(m,r.dataSource);var g='<div class="per-frame-header"><div '+this.navigationActiveMarker+' class="per-frame-nav_button active"></div>'+'<div class="per-frame-title">'+v+"><span "+this.subTitleMarker+"></span></div>"+'<div class="per-frame-nav_header_right"><div class="per-frame-user">'+"<div "+this.userNameMarkder+' class="user-title"><b>v</b>'+h+d+"</div>"+'<div class="user-con" style="display: none;"><ul>'+m+"</ul></div></div></div></div>",y='<div class="per-frame-main"><iframe '+this.iframeMarker+' src="" style="height: 100%; width: 100%;"></iframe></div>';return"<div "+this.ptool.maxDivMarker+' class="per-frame-normal"{{id}}>'+g+c+y+"</div>"},pframe_template.prototype.joinUrl=function(e){return e+=(e.indexOf("?")>-1?"&":"?")+pconst.pticket+"="+(window[pconst.pticket]||""),e};function pframe(){this.constructor=arguments.callee}pframe.prototype=new pframe_template,pframe.prototype.init=function(e,t,n){var r=t.attr;r.bind=!0;var i=n.find("user"),s=i.find("item");r.header={title:r.title,uhead:i.attr("head"),uname:i.attr("name"),dataSource:s.attr("datasource"),text:s.attr("text"),click:s.attr("click")};var o=n.children().filter("item"),u=o.find("manage"),a=o.find("combobox");r.item={datasource:o.attr("datasource"),text:o.attr("text"),icon:o.attr("icon"),url:o.attr("url"),click:o.attr("click"),child:o.attr("child"),manageText:u.attr("text"),manageIcon:u.attr("icon")||"'u'",manageClick:u.attr("click"),manageUrl:u.attr("url"),comboxHtml:a.html()};var f=this.getTemplateStr(t,e);this.renderView(f,this.controlTypes.pframe.name,e,t,n)},pframe.prototype.rendered=function(e,t,n){var r=this,i=t.attr,s=t.event,o=ptool.getJqElement(e),u=o.find("["+this.navigationActiveMarker+"]");this.createEvent(u,this.controlTypes.pframe.name,"mouseenter",window[this.ptool.pstaticEventFnName]),this.createEvent(u,this.controlTypes.pframe.name,"mouseleave",window[this.ptool.pstaticEventFnName]);var a=o.find("["+this.navigationMarker+"]");this.createEvent(a,this.controlTypes.pframe.name,"mouseenter",window[this.ptool.pstaticEventFnName]),this.createEvent(a,this.controlTypes.pframe.name,"mouseleave",window[this.ptool.pstaticEventFnName]);var f=o.find("["+this.userNameMarkder+"]");this.createEvent(f,this.controlTypes.pframe.name,"click",window[this.ptool.pstaticEventFnName]);var l=o.find("["+this.systemManagerMarker+"]");this.createEvent(l,this.controlTypes.pframe.name,"click",window[this.ptool.pstaticEventFnName])},pframe.prototype.eventHandout=function(e,t){var n=this,r=$(t[this.ptool.eventCurrTargetName]),i=t.type,s=$(t.currentTarget),o=r.attr(this.ptool.libraryIdToHtml),u=pframe[o],a=u.attr,f=a.header,l=a.item,c=r.find("["+this.navigationActiveMarker+"]"),h=r.find("["+this.navigationMarker+"]");switch(i){case"mouseenter":h.css({left:"0px"}),c.removeClass(this.navigationNoActiveCss);break;case"mouseleave":h.css({left:"-222px"}),c.addClass(this.navigationNoActiveCss);break;case"click":if(s.attr(this.userNameMarkder)!=null)s.next().toggle();else if(s.attr(this.userMenuItemMarker)!=null){var p=s.index();t=this.ptool.appendProToEvent(t,{index:p}),this.executeEventCall(e,t,f.click),r.find("["+this.userNameMarkder+"]")[0].click()}else if(s.attr(this.systemManagerMarker)!=null)r.find("["+this.subTitleMarker+"]").text(l.manageText),r.find("["+this.iframeMarker+"]").attr("src",l.manageUrl),this.executeEventCall(e,t,l.manageClick);else if(s.attr(this.menuLiMarker)!=null){var d=e[l.url],v=this.joinUrl(d),m=e[l.text];r.find("["+this.subTitleMarker+"]").text(m),r.find("["+this.iframeMarker+"]").attr("src",v),this.executeEventCall(e,t,l.click)}}},pframe.prototype.psel=function(e){var t=arguments[0],n=$(t);e=arguments[1]||{};var r=e.groupIndex,i=e.itemIndex,s=e.subTitle||"",o=e.url||"";if(o)n.find("["+this.subTitleMarker+"]").text(s),n.find("["+this.iframeMarker+"]").attr("src",o);else{var u=n.find("["+this.navigationMenuUlMarker+"]").eq(r);u.find("["+this.menuLiMarker+"]")[i].click()}};function pgrid_template(){this.constructor=arguments.callee,this.normalFirstColumMarker="nfcm",this.normalFirstColumConUlMarker="nfccum",this.normalRightColumnUlMarker="nrcum",this.normalRightConUlMarker="nrconum",this.normalRightConScrollRegionMarker="nrcsrm",this.normalLeftRegionConMarker="nlrcm",this.multiPagingMarker="mpm",this.multiGridLeftComboxMarker="mplcm",this.multiGridConCheckboxMarker="mgccbm",this.multiGridConUlMarker="mgcum",this.multiGridConMarker="mgcm",this.multiGridSortHeadMarker="mgshm",this.multiGridSortIconMarker="mgsim",this.multiGridOutHeaderMarker="mgohm",this.multiGridColumnHeaderMarker="mgchm",this.conColumnMarker="ccm",this.conLineMarker="clm",this.nodataMarker="ndm",this.quickSelLinePrefix="已选：",this.quickSelLineSperator="/",this.pageSize=20,this.normalFirstConLi="<li "+this.conLineMarker+" "+this.normalFirstColumMarker,this.normalFirstConLi2="><em {{text}}></em></li>",this.normalRightConColumn="<div "+this.conColumnMarker,this.normalRightConColumn3="><em {{text}}></em></div>",this.normalRightConColumn1="<li "+this.conLineMarker+" {{click}}>",this.normalRightConColumn2="</li>",this.sortIconCss={asc:"icon-up",desc:"icon-down"}}pgrid_template.prototype=new persagyElement,pgrid_template.prototype.getTemplateStr=function(e,t){function j(){return"<div "+n.nodataMarker+' class="per-grid-nodata"><pnotice-nodata text="暂无数据" subtitle="请检查网络是否通畅"></pnotice-nodata></div>'}function F(e,t){if(!e)return"";var r=$("<div "+n.multiPagingMarker+'="'+t+'" class="per-grid-paging">'+e+"</div>"),i=r.children().eq(0);return i.attr("number","0"),i.attr("sel","pgrid.pageSelEvent"),r[0].outerHTML}var n=this,r=t.attr,i=r.panel,s=r.columns;switch(e){case this.controlTypes.pgrid.types[0]:var o="",u=s[0];if(i.lock==1){var a=this.normalFirstConLi+(i.columnclick?" {{click}}":"")+this.normalFirstConLi2;a=this.joinHtmlToBindByAttrCss(a,{text:u.source},{},{},!0),a=this.createForBind(a,i.datasource),o='<div class="per-grid-normal_l"><div class="per-grid-normal_column">'+u.name+"</div><div "+this.normalLeftRegionConMarker+'  class="per-grid-normal_ul"><ul '+this.normalFirstColumConUlMarker+' style="top: 0px;">'+a+"</ul></div></div>"}var f="",l="",c="",h="",p=i.lock?1:0;for(p;p<s.length;p++){var d=s[p];l+="<li><em>"+d.name+"</em></li>";var v=this.normalRightConColumn+(i.columnclick?" {{click}}":"")+this.normalRightConColumn3;h+=this.joinHtmlToBindByAttrCss(v,{text:d.source},{},{},!0)}f='<div class="per-grid-normal_title"><ul '+this.normalRightColumnUlMarker+' style="left: 0px;">'+l+"</ul></div>",c=this.normalRightConColumn1+h+this.normalRightConColumn2,c=this.joinHtmlToBindByAttrCss(c,{},{},{},!0),c=this.createForBind(c,i.datasource);var m="<div "+this.normalRightConScrollRegionMarker+' class="per-grid-normal_con scroll_big"><div class="per-grid-nomal-wrap"><ul '+this.normalRightConUlMarker+">"+c+"</ul></div></div>",g='<div class="per-grid-normal_r">'+f+m+"</div>",y=j(),b=F(r.pageHtml,this.controlTypes.pgrid.types[0]);return"<div "+this.ptool.maxDivMarker+' class="per-grid-normal" {{id}}><div class="per-grid-normal_main">'+o+g+y+b+"</div></div>";default:var w="";if(i.checkbox||r.customButtonHtml){var E="";i.checkbox&&(E='<div class="per-grid-dynamic_header_left"><pcombobox-menuminor '+this.multiGridLeftComboxMarker+' sel="pgrid.quickSelLineEvent">'+'<header placeholder="'+this.quickSelLinePrefix+"0"+this.quickSelLineSperator+'0"></header>'+'<item datasource="pgrid.multiGridTopLeftComboxSource" text="name"></item></pcombobox-menuminor></div>');var S="";r.customButtonHtml&&(S='<div class="per-grid-dynamic_header_right">'+r.customButtonHtml+"</div>"),w="<div "+this.multiGridOutHeaderMarker+' class="per-grid-dynamic_header">'+E+S+"</div>"}var x="",T="",N=[];if(i.templateid){var C="<div>"+document.getElementById(i.templateid).innerHTML+"</div>";N=$(C).children()}var k=i.checkbox?'<div class="per-grid-dynamic_item _grid-cheackbox"></div>':"";for(var p=0;p<s.length;p++){var L=s[p],A=L.width?' style="width:'+L.width+';"':"";k+="<div"+A+' class="per-grid-dynamic_item'+(L.sort?" _grid-sort":"")+'"'+(L.sort?" "+this.multiGridSortHeadMarker+'="'+L.defaultsort+'"':"")+"><b>"+(L.sort?"<em>"+L.name+'</em><span class="icon '+this.sortIconCss[L.defaultsort]+'" '+this.multiGridSortIconMarker+"></span>":L.name)+"</b></div>";var O=N[p]?N[p].outerHTML:"<em {{text}}></em>",M="<div "+this.conColumnMarker+A+' class="per-grid-dynamic_item"'+(i.columnclick?" {{click}}":"")+">"+O+"</div>";M=this.joinHtmlToBindByAttrCss(M,{text:L.source},{},{},!0),T+=M}i.operation&&(k+='<div class="per-grid-dynamic_item  _grid-dynamic_item-icon"></div>',T+='<div class="per-grid-dynamic_item _grid-dynamic_item-icon">'+(N[N.length-1].outerHTML||"")+"</div>"),k="<div "+this.multiGridColumnHeaderMarker+' class="per-grid-dynamic_title"><ul><li class="per-grid-dynamic_li _dynamic-title-height">'+k+"</li></ul></div>",i.checkbox&&(T='<div class="per-grid-dynamic_item _grid-cheackbox"><pswitch-checkbox '+this.multiGridConCheckboxMarker+' change="pgrid.checkboxSelEvent" bind="true">'+"</pswitch-checkbox></div>"+T),T="<li "+this.conLineMarker+' class="per-grid-dynamic_li" {{click}}>'+T+"</li>",T=this.joinHtmlToBindByAttrCss(T,{},{},{},!0),T=this.createForBind(T,i.datasource);var _="<ul "+this.multiGridConUlMarker+">"+T+"</ul>",D=$(_);D.prender(),_=D[0].outerHTML;var P=this.ptool.createDynamicTemplate(_),H="<div "+this.multiGridConMarker+' class="per-grid-dynamic_con"><pscroll-small templateid="'+P+'"></pscroll-small></div>',B=F(r.pageHtml,this.controlTypes.pgrid.types[1]),y=j();return x='<div class="per-grid-dynamic_wrap">'+k+H+B+y+"</div>","<div {{id}} "+this.ptool.maxDivMarker+'  class="per-grid-dynamic">'+w+x+"</div>"}};function pgrid(){this.constructor=arguments.callee}pgrid.prototype=new pgrid_template,pgrid.multiGridTopLeftComboxSource=[{name:"选择全部"},{name:"选择本页"},{name:"本页反选"},{name:"全不选"}],pgrid.prototype.init=function(e,t,n){var r=t.attr,i=t.event,s=t.css;r.bind=!0;var o=n.find("panel"),u=o.attr("checkbox")=="true"?!0:!1,a=o.attr("operation")=="true"?!0:!1,f=o.attr("lock")=="true"?!0:!1;r.panel={datasource:o.attr("datasource"),checkbox:u,templateid:o.attr("templateid"),lineclick:o.attr("lineclick"),columnclick:o.attr("columnclick"),sel:o.attr("sel"),change:o.attr("change"),lock:f,operation:a,pagesize:parseInt(o.attr("pagesize"))||this.pageSize,sortevent:o.attr("sortevent")};var l=n.find("header").find("column"),c=[];for(var h=0;h<l.length;h++){var p=l.eq(h),d=p.attr("sort")=="true"?!0:!1,v=p.attr("defaultsort")||this.ptool.sortType.asc;c.push({name:p.attr("name"),source:p.attr("source"),sort:d,defaultsort:v,width:p.attr("width")})}r.columns=c,r.customButtonHtml=n.find("button").html(),r.pageHtml=n.find("page").html();var m=this.getTemplateStr(e,t);this.renderView(m,this.controlTypes.pgrid.name,e,t,n)},pgrid.prototype.rendered=function(e,t){if(!t)return;var n=t.attr,r=t.event,i=ptool.getJqElement(e),s=this.ptool.getTypeAndChildTypeFromEle(i);switch(s.childType){case this.controlTypes.pgrid.types[0]:this.createEvent(i.find("["+this.normalRightConScrollRegionMarker+"]"),this.controlTypes.pgrid.name,"scroll",window[this.ptool.pstaticEventFnName]);var o=i.find("["+this.normalRightConUlMarker+"]");this.createEvent(o,this.controlTypes.pgrid.name,"DOMSubtreeModified",window[this.ptool.pstaticEventFnName]);break;case this.controlTypes.pgrid.types[1]:var u=i.find("["+this.multiGridSortHeadMarker+"]");for(var a=0;a<u.length;a++)this.createEvent(u[a],this.controlTypes.pgrid.name,"click",window[this.ptool.pstaticEventFnName]);var f=i.find("["+this.multiGridConUlMarker+"]"),l=i.attr(this.ptool.libraryIdToHtml),c=this.controlTypes.pgrid.name+this.ptool.typeSeparator+this.controlTypes.pgrid.types[1];f.attr(this.ptool.libraryTypeToHtml,c),f.attr(this.ptool.libraryIdToHtml,l),this.createEvent(f,this.controlTypes.pgrid.name,"DOMSubtreeModified",window[this.ptool.pstaticEventFnName]);var h=i.width(),p=i.height(),d=70,v=i.find("["+this.multiGridOutHeaderMarker+"]").height()||0,m=32;p=p-d-v-m;var g="["+this.ptool.libraryTypeToHtml+'="'+this.controlTypes.pscroll.name+this.ptool.typeSeparator+this.controlTypes.pscroll.types[0]+'"]';i.find(g).css({"max-width":h+"px","max-height":p+"px"})}this.isShowNoData(s.childType,i)},pgrid.prototype.eventHandout=function(e,t){var n=t.currentTarget,r=$(n),i=$(t[this.ptool.eventCurrTargetName]);i.attr(this.ptool.maxDivMarker)==null&&(i=this.findMaxJqTarget(i.parent(),this.controlTypes.pgrid.types[1]),i||(i=this.findMaxJqTarget(i.parent(),this.controlTypes.pgrid.types[0])));var s=i.attr(this.ptool.libraryIdToHtml),o=pgrid[s],u=o.attr,a=this.ptool.getTypeAndChildTypeFromEle(i),f=u.panel,l=u.columns,c=t.type;switch(c){case"scroll":var h=n.scrollTop,p=n.scrollLeft;i.find("["+this.normalRightColumnUlMarker+"]").css({left:"-"+p+"px"}),i.find("["+this.normalFirstColumConUlMarker+"]").css({top:"-"+h+"px"});break;case"click":if(r.attr(this.multiGridSortHeadMarker)!=null){var d=r.index();f.checkbox&&--d;var v=r.attr(this.multiGridSortHeadMarker),m=v==this.ptool.sortType.asc?this.ptool.sortType.desc:this.ptool.sortType.asc;t=this.ptool.appendProToEvent(t,{columnIndex:d,sortType:m}),this.executeEventCall(null,t,f.sortevent);var g=r.find("["+this.multiGridSortIconMarker+"]");g.removeClass(this.sortIconCss[v]),g.addClass(this.sortIconCss[m]),r.attr(this.multiGridSortHeadMarker,m);return}if(r.attr(this.conColumnMarker)!=null){var d=r.index();f.checkbox&&--d,f.lock&&++d;var y=l[d],b=r.parent("["+this.conLineMarker+"]:first"),w=b.index();t=this.ptool.appendProToEvent(t,{columnIndex:d,lineIndex:w}),this.executeEventCall(e,t,f.columnclick);return}if(r.attr(this.conLineMarker)!=null){var w=r.index(),E=f.lineclick;t=this.ptool.appendProToEvent(t,{lineIndex:w}),this.executeEventCall(e,t,E);return}break;case"DOMSubtreeModified":this.isShowNoData(a.childType,i)}},pgrid.prototype.isShowNoData=function(e,t,n){var r=t.find("["+this.nodataMarker+"]"),i=t.find("["+this.multiPagingMarker+"]");n=n===!0?!0:!1;switch(e){case this.controlTypes.pgrid.types[0]:var s=t.find("["+this.normalRightConUlMarker+"]"),o=t.find("["+this.normalLeftRegionConMarker+"]"),u=t.find("["+this.normalRightConScrollRegionMarker+"]");n===!0||s.children().length==0?(o.hide(),u.hide(),i.hide(),r.show()):(r.hide(),o.show(),u.show(),i.show());break;case this.controlTypes.pgrid.types[1]:var a=t.find("["+this.multiGridConMarker+"]"),f=t.find("["+this.multiGridConUlMarker+"]");n===!0||f.children().length==0?(a.hide(),i.hide(),r.show()):(r.hide(),a.show(),i.show())}},pgrid.prototype.pcount=function(e){var t=arguments[0],n=$(t),r=this.ptool.getTypeAndChildTypeFromEle(n),i=n.attr(this.ptool.libraryIdToHtml),s=pgrid[i];if(arguments.length==1)return s.pageCount||0;e=parseInt(arguments[1])||0;var o=s.attr,u=o.panel.pagesize,a=Math.ceil(Math.division(e,u));s.pageCount=a,s.count=e,s.selAll==1&&(s.selCount=e),pgrid[i]=s,n.find("["+this.multiPagingMarker+"]").pcount(a),this.setLeftComboxHeaderText(n)},pgrid.prototype.precover=function(){var e=arguments[0],t=$(e),n=this.ptool.getTypeAndChildTypeFromEle(t),r=t.find("["+this.multiPagingMarker+"]");r.psel(1,!1);if(n.childType===this.controlTypes.pgrid.types[0])return;var i=t.attr(this.ptool.libraryIdToHtml),s=pgrid[i],o=s.attr;s.pageCount=0,s.count=0,s.selAll=!1,s.selCount=0,s.pageIndex=1,pgrid[i]=s,r.pcount(1),this.setLeftComboxHeaderText(t),this.isShowNoData(n.childType,t,!0)},pgrid.prototype.findMaxJqTarget=function(e,t){var n=$(e),r=this.controlTypes.pgrid.name+this.ptool.typeSeparator+t,i=0;while(n.attr(this.ptool.libraryTypeToHtml)!==r||n.attr(this.ptool.maxDivMarker)==null){n=n.parent(),++i;if(i>50)break}return i>50?!1:n},pgrid.prototype.setLeftComboxHeaderText=function(e){var t=e.attr(this.ptool.libraryIdToHtml),n=pgrid[t];n.selAll==1&&(n.selCount=n.count,pgrid[t]=n);var r=this.quickSelLinePrefix+(n.selCount||0)+this.quickSelLineSperator+(n.count||0);(new pcombobox).setHeaderText(e.find("["+this.multiGridLeftComboxMarker+"]"),r)},pgrid.prototype.psel=function(e,t){var n=arguments[0],r=$(n),i=r.attr(this.ptool.libraryIdToHtml),s=pgrid[i];if(arguments.length==1)return s.pageIndex||1;e=parseInt(arguments[1]),t=arguments[2]===!1?!1:!0;if(!e)return s.pageIndex||1;if(t)return r.find("["+this.multiPagingMarker+"]").psel(e);s.pageIndex=e,pgrid[i]=s},pgrid.quickSelLineEvent=function(e){var t=new pgrid,n=e[t.ptool.eventOthAttribute].index,r=$(e[t.ptool.eventCurrTargetName]),i=t.findMaxJqTarget(r.parent(),t.controlTypes.pgrid.types[1]),s=i.find("["+t.multiGridConCheckboxMarker+"]"),o=i.attr(t.ptool.libraryIdToHtml),u=pgrid[o],a=u.selCount||0;switch(n){case 0:a=u.count,u.selAll=!0;break;case 1:u.selAll=!1,a=i.find("["+t.multiGridConUlMarker+"]").children().length;break;case 2:u.selAll=!1,a=0;for(var f=0;f<s.length;f++){var l=s[f],c=!l.psel();c&&++a,s[f].psel(c,!1)}break;case 3:u.selAll=!1,a=0}u.selCount=a,pgrid[o]=u,t.setLeftComboxHeaderText(i);if(n!=2)for(var f=0;f<s.length;f++){var c=a===0?!1:!0;s[f].psel(c,!1)}},pgrid.checkboxSelEvent=function(e,t){var n=new pgrid,r=t[n.ptool.eventOthAttribute].state,i=$(t[n.ptool.eventCurrTargetName]),s=n.findMaxJqTarget(i.parent(),n.controlTypes.pgrid.types[1]),o=s.attr(n.ptool.libraryIdToHtml),u=pgrid[o],a=u.selCount||0;r?++a:--a,u.selCount=a,pgrid[o]=u,n.setLeftComboxHeaderText(s),t=n.ptool.appendProToEvent(t,{state:r}),n.executeEventCall(e,t,u.attr.panel.change)},pgrid.pageSelEvent=function(e){var t=new pgrid,n=e[t.ptool.eventOthAttribute].pageIndex,r=$(e[t.ptool.eventCurrTargetName]),i=r.parent(),s=i.attr(t.multiPagingMarker),o=t.findMaxJqTarget(i,s),u=o.attr(t.ptool.libraryIdToHtml),a=pgrid[u];s===t.controlTypes.pgrid.types[1]&&(a.pageIndex=n,a.selAll!=1&&(a.selCount=0,pgrid[u]=a,t.setLeftComboxHeaderText(o))),e=t.ptool.appendProToEvent(e,{pageIndex:n}),t.executeEventCall(null,e,a.attr.panel.sel)} ;})();